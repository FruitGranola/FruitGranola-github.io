<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Logistic_Regression_interaction</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Sort Horiiのメモ帳</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Data Visualization</li>
    <li>
      <a href="Barplot.html">Barplot</a>
    </li>
    <li>
      <a href="Histogram.html">Histogram</a>
    </li>
    <li>
      <a href="Boxplot.html">Boxplot</a>
    </li>
    <li>
      <a href="Scatterplot.html">Scatterplot</a>
    </li>
    <li>
      <a href="Lineplot.html">Lineplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Regression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Regression</li>
    <li>
      <a href="Multiple_Linear_Regression.html">Multiple Linear Regression</a>
    </li>
    <li>
      <a href="Multiple_Linear_Regression_interaction.html">Multiple Linear Regression interaction</a>
    </li>
    <li>
      <a href="Logistic_Regression.html">Logistic Regression</a>
    </li>
    <li>
      <a href="Logistic_Regression_interaction.html">Logistic Regression interaction</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Logistic_Regression_interaction</h1>
<h4 class="date">2021-02-21 12:27:30</h4>

</div>


<style>
  
  table, td, th {
    border: none;
    padding-left: 1em;
    padding-right: 1em;
    min-width: 75%;
    margin-left: auto;
    margin-right: auto;
    margin-top: 1em;
    margin-bottom: 1em;
  }

</style>
<div id="使用するパッケージ" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> 使用するパッケージ</h1>
<pre class="r"><code># 使用するパッケージ

library(tidyverse)
library(patchwork)
library(magrittr)
library(stargazer)
library(ROCR)
library(broom)
library(margins)

theme_set(theme_minimal(base_family = 15))

# ggplot2 の theme をあらかじめ設定しておく

theme_set(theme_minimal(base_size = 15))</code></pre>
</div>
<div id="データ" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> データ</h1>
<p>データは<a href="./data/House_of_Councilors_1996_2017.csv">こちら</a></p>
<pre class="r"><code>data &lt;- read_csv(&quot;Data/House_of_Councilors_1996_2017.csv&quot;)</code></pre>
<p>今回使用するデータは、私のQiitaではお馴染みの衆院選データです。</p>
<div id="データの操作" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> データの操作</h2>
<pre class="r"><code>data %&lt;&gt;% 
  dplyr::filter(year == 2005) %&gt;% 
  dplyr::mutate(&quot;party_size&quot; = if_else(party_jpn %in% c(&quot;自民党&quot;, &quot;民主党&quot;), 1, 0)) %&gt;%  
  dplyr::select(smd, expm, previous, party_size) %&gt;% 
  drop_na() %&gt;% 
  as.data.frame()</code></pre>
<p>2005年の衆院選を対象とします。<br />
また、ダミー変数を作成して変数選択を行いました。<br />
naを持つ個体に関しては、全て排除しました。</p>
</div>
<div id="要約統計量" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> 要約統計量</h2>
<pre class="r"><code>stargazer(data,
          type = &quot;html&quot;,
          summary.stat = c(&quot;n&quot;, &quot;sd&quot;, &quot;min&quot;, &quot;mean&quot;, &quot;max&quot;))</code></pre>
<table style="text-align:center">
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Mean
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
smd
</td>
<td>
985
</td>
<td>
0.460
</td>
<td>
0
</td>
<td>
0.303
</td>
<td>
1
</td>
</tr>
<tr>
<td style="text-align:left">
expm
</td>
<td>
985
</td>
<td>
5.570
</td>
<td>
0.063
</td>
<td>
8.142
</td>
<td>
24.650
</td>
</tr>
<tr>
<td style="text-align:left">
previous
</td>
<td>
985
</td>
<td>
2.684
</td>
<td>
0
</td>
<td>
1.922
</td>
<td>
16
</td>
</tr>
<tr>
<td style="text-align:left">
party_size
</td>
<td>
985
</td>
<td>
0.493
</td>
<td>
0
</td>
<td>
0.587
</td>
<td>
1
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<table>
<thead>
<tr class="header">
<th>変数名</th>
<th>内容</th>
<th>備考</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>smd</td>
<td>当落　</td>
<td>0=落選、1=当選</td>
</tr>
<tr class="even">
<td>expm</td>
<td>選挙費用</td>
<td>単位: 百万円</td>
</tr>
<tr class="odd">
<td>previous</td>
<td>当選回数</td>
<td></td>
</tr>
<tr class="even">
<td>party_size</td>
<td>政党規模</td>
<td>0 = その他、1 = 自民・民主</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="交差項とは" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> 交差項とは</h1>
<p><img src="Logistic_Regression_interaction_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>上記の図はダミー変数と交差項の回帰直線の違いを可視化したものだ。<br />
交差項を使うと、調整変数が取る値によって、AME(平均限界効果)が異なることを捉えることができる、</p>
</div>
<div id="連続変数とカテゴリカル変数での交差項" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> 連続変数とカテゴリカル変数での交差項</h1>
<div id="交差項を含む重回帰分析" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> 交差項を含む重回帰分析</h2>
<pre class="r"><code>model_1 &lt;- glm(smd ~ expm + previous + party_size + expm:party_size, data, family = binomial(link = &quot;logit&quot;))</code></pre>
<pre class="r"><code>stargazer(model_1,
          type = &quot;html&quot;,
          style = &quot;all2&quot;,
          digits = 2, 
          align = T, # 中央揃え
          keep.stat = c(&quot;n&quot;, &quot;adj.rsq&quot;, &quot;f&quot;))</code></pre>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
smd
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
expm
</td>
<td>
0.24<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.05)
</td>
</tr>
<tr>
<td style="text-align:left">
previous
</td>
<td>
0.52<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.05)
</td>
</tr>
<tr>
<td style="text-align:left">
party_size
</td>
<td>
2.67<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.63)
</td>
</tr>
<tr>
<td style="text-align:left">
expm:party_size
</td>
<td>
-0.14<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.05)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-5.27<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.57)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
985
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>このままでは解釈が難しいので、以下のようにオッズと当選確率を計算する。<br />
こうすることで、分析結果の解釈を可能にする。</p>
<div id="オッズ比" class="section level3" number="4.1.1">
<h3 number="4.1.1"><span class="header-section-number">4.1.1</span> オッズ比</h3>
<pre class="r"><code>exp(model_1$coefficients)</code></pre>
<pre><code>    (Intercept)            expm        previous      party_size expm:party_size 
     0.00513729      1.26983976      1.67619411     14.37886256      0.87068851 </code></pre>
<p>Constant: 全説明変数が0の時に「応答変数が1になる」オッズ</p>
<p>estimate: 他の説明変数を平均値で固定し、変数を1単位増やしたときに「応答変数が1になる」オッズ</p>
</div>
<div id="当選確率" class="section level3" number="4.1.2">
<h3 number="4.1.2"><span class="header-section-number">4.1.2</span> 当選確率</h3>
<pre class="r"><code>1 / (1 + exp(-model_1$coefficients))</code></pre>
<pre><code>    (Intercept)            expm        previous      party_size expm:party_size 
    0.005111033     0.559440266     0.626335027     0.934975685     0.465437460 </code></pre>
<p>estimate: 他の説明変数を平均値で固定し、その変数を1単位増やしたときに「応答変数が1になる」確率</p>
<p>このようにオッズや確率に変換することで、解釈可能性を上げることができるが、 これでもまだ、直感的に理解することは難しい。そのため、限界効果や当選確率の可視化が重要になる。</p>
</div>
</div>
<div id="モデルの評価" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> モデルの評価</h2>
<div id="roc曲線" class="section level3" number="4.2.1">
<h3 number="4.2.1"><span class="header-section-number">4.2.1</span> ROC曲線</h3>
<pre class="r"><code>roc &lt;- model_1 %&gt;% 
  predict(type = &quot;response&quot;) %&gt;% 
  ROCR::prediction(labels = data$smd == 1) %&gt;% 
  performance(&quot;tpr&quot;, &quot;fpr&quot;) 

df_roc &lt;- data.frame(tpr = roc@y.values[[1]], fpr = roc@x.values[[1]])

ggplot(df_roc, aes(x = fpr, y = tpr)) + 
  geom_line(color = &quot;red&quot;) +
  geom_abline(intercept = 0, slope = 1, linetype = &quot;dashed&quot;) +
  scale_linetype_discrete(name = &quot;&quot;) +
  scale_color_discrete(name = &quot;&quot;) +
  coord_fixed() +
  labs(x = &quot;偽陽性率(1 - 特異度)&quot;, y = &quot;真陽性率(感度)&quot;)</code></pre>
<p><img src="Logistic_Regression_interaction_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>ROC曲線が対角線より左上にあり、(0, 1)に向かって線が良く伸びていることから、モデルの当てはまりは良さそう。<br />
目視では判断が難しい場合はAUCを算出する。</p>
</div>
<div id="auc" class="section level3" number="4.2.2">
<h3 number="4.2.2"><span class="header-section-number">4.2.2</span> AUC</h3>
<pre class="r"><code>auc &lt;- model_1 %&gt;% 
  predict(type = &quot;response&quot;) %&gt;% 
  ROCR::prediction(labels = data$smd == 1) %&gt;% 
  performance(&quot;auc&quot;)

auc@y.values[[1]]</code></pre>
<pre><code>[1] 0.914305</code></pre>
<p>AUC値は0.5～1までの値を取る。1に近いほどモデルの当てはまりが良い。<br />
今回のモデルのAUCは0.914305で非常に当てはまりが良い。</p>
</div>
</div>
<div id="実質的な有意性への言及" class="section level2" number="4.3">
<h2 number="4.3"><span class="header-section-number">4.3</span> 実質的な有意性への言及</h2>
<div id="限界効果" class="section level3" number="4.3.1">
<h3 number="4.3.1"><span class="header-section-number">4.3.1</span> 限界効果</h3>
<pre class="r"><code>margins_1 &lt;- summary(margins(model_1, 
                             at = list(party_size = 0:1),
                             type = &quot;link&quot;)) %&gt;% 
  dplyr::filter(factor == &quot;expm&quot;) %&gt;% 
  as.data.frame()</code></pre>
<pre class="r"><code>margins_1 %&gt;% 
  ggplot(aes(x = party_size, y = AME)) +
  geom_pointrange(aes(ymin = lower, ymax = upper,
                      color = as.factor(party_size)),
                  size = 2,
                  show.legend = F) +
  geom_hline(yintercept = 0, 
             linetype = 2,
             color = &quot;red&quot;) +
  geom_text(aes(label = round(AME, 2)),
            hjust = 2) +
  scale_x_continuous(breaks = c(0, 1), 
                     labels = c(&quot;0&quot;, &quot;1&quot;)) +
  labs(x = NULL, 
       y = &quot;expmがvoteshareに与える影響（限界効果)&quot;,
       title = &quot;限界効果&quot;) +
  coord_trans(xlim = c(-0.5, 1.5))</code></pre>
<p><img src="Logistic_Regression_interaction_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>表では解釈が難しかったが、このように図に表すと分かりやすいだろう。<br />
両方とも赤い点線を跨いでいないことから、<br />
調整変数の値によってexpmが当選確率に与える影響が異なることが統計的に有意であったとわかった。<br />
expmが1単位増加すると、party_sizeが0の場合は平均して0.24%pt、party_sizeが1の場合は平均して0.1%pt増加する。</p>
</div>
<div id="予測確率" class="section level3" number="4.3.2">
<h3 number="4.3.2"><span class="header-section-number">4.3.2</span> 予測確率</h3>
<pre class="r"><code>prediction_1 &lt;- function(x){
  model_1 %&gt;% 
  predict(newdata = data.frame(expm = min(data$expm):max(data$expm), 
                               previous = mean(data$previous),
                               party_size = x), 
          se.fit = TRUE) %&gt;% 
    as.data.frame() %&gt;% 
    mutate(ll = fit + qnorm(0.025) * se.fit,
           ul = fit + qnorm(0.975) * se.fit,
           estimate = (1 / (1 + exp(-fit))),
           lower = (1 / (1 + exp(-ll))),
           upper = (1 / (1 + exp(-ul))),
           expm = min(data$expm):max(data$expm),
           party_size = x)
}

pred_1 &lt;- lapply(X = 0:1, FUN = prediction_1)

pred_1 %&lt;&gt;% bind_rows(pred_1[1], pred_1[2])

pred_1 %&gt;% 
  ggplot(aes(x = expm, y = estimate, 
             fill = as.factor(party_size))) +
  geom_line() +
  geom_ribbon(aes(ymin = lower, ymax = upper),
              alpha =.3,
              show.legend = F) +
  lims(y = c(0, 1)) +
  labs(y = &quot;voteshareの予測値&quot;, title = &quot;予測確率&quot;) +
  facet_wrap(~ party_size,
             labeller = as_labeller(c(`0` = &quot;その他&quot;,
                                      `1` = &quot;自民・民主&quot;))) </code></pre>
<p><img src="Logistic_Regression_interaction_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>expmが増加すると、当選確率も増加する。また、その他の政党のほうがexpmが上昇した際の当選確率の上がり方が顕著である。<br />
その他の政党の場合、exppmが10を超えたあたりから急激に影響が強くなるようだ。<br />
ただ、当選確率が50%になるのは自民・民主のほうが早い。このことから、自民・民主の候補者はより安価に当選が狙えるようだ。</p>
</div>
</div>
</div>
<div id="連続変数と連続変数での交差項" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> 連続変数と連続変数での交差項</h1>
<div id="交差項を含む重回帰分析-1" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> 交差項を含む重回帰分析</h2>
<pre class="r"><code>model_2 &lt;- glm(smd ~ expm + previous + party_size + expm:previous, data, family = binomial(link = &quot;logit&quot;))</code></pre>
<pre class="r"><code>stargazer(model_2,
          type = &quot;html&quot;,
          style = &quot;all2&quot;,
          digits = 2, 
          align = T, # 中央揃え
          keep.stat = c(&quot;n&quot;, &quot;adj.rsq&quot;, &quot;f&quot;))</code></pre>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
smd
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
expm
</td>
<td>
0.20<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.03)
</td>
</tr>
<tr>
<td style="text-align:left">
previous
</td>
<td>
0.83<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.13)
</td>
</tr>
<tr>
<td style="text-align:left">
party_size
</td>
<td>
1.18<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.28)
</td>
</tr>
<tr>
<td style="text-align:left">
expm:previous
</td>
<td>
-0.03<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.01)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-4.85<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.41)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
985
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>このままでは解釈できないので、以下のようにオッズと当選確率を計算する。<br />
こうすることで、分析結果の解釈を可能にする。</p>
<div id="オッズ比-1" class="section level3" number="5.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> オッズ比</h3>
<pre class="r"><code>exp(model_2$coefficients)</code></pre>
<pre><code>  (Intercept)          expm      previous    party_size expm:previous 
  0.007808072   1.216156367   2.296635151   3.268965246   0.973296417 </code></pre>
<p>Constant: 全説明変数が0の時に「応答変数が1になる」オッズ</p>
<p>estimate: 他の説明変数を平均値で固定し、変数を1単位増やしたときに「応答変数が1になる」オッズ</p>
</div>
<div id="当選確率-1" class="section level3" number="5.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> 当選確率</h3>
<pre class="r"><code>1 / (1 + exp(-model_2$coefficients))</code></pre>
<pre><code>  (Intercept)          expm      previous    party_size expm:previous 
  0.007747579   0.548768302   0.696660396   0.765751197   0.493233763 </code></pre>
<p>estimate: 他の説明変数を平均値で固定し、その変数を1単位増やしたときに「応答変数が1になる」確率</p>
<p>このようにオッズや確率に変換することで、解釈可能性を上げることができるが、 これでもまだ、直感的に理解することは難しい。そのため、限界効果や当選確率の可視化が重要になる。</p>
</div>
</div>
<div id="モデルの評価-1" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> モデルの評価</h2>
<div id="roc曲線-1" class="section level3" number="5.2.1">
<h3 number="5.2.1"><span class="header-section-number">5.2.1</span> ROC曲線</h3>
<pre class="r"><code>roc &lt;- model_2 %&gt;% 
  predict(type = &quot;response&quot;) %&gt;% 
  ROCR::prediction(labels = data$smd == 1) %&gt;% 
  performance(&quot;tpr&quot;, &quot;fpr&quot;) 

df_roc &lt;- data.frame(tpr = roc@y.values[[1]], fpr = roc@x.values[[1]])

ggplot(df_roc, aes(x = fpr, y = tpr)) + 
  geom_line(color = &quot;red&quot;) +
  geom_abline(intercept = 0, slope = 1, linetype = &quot;dashed&quot;) +
  scale_linetype_discrete(name = &quot;&quot;) +
  scale_color_discrete(name = &quot;&quot;) +
  coord_fixed() +
  labs(x = &quot;偽陽性率(1 - 特異度)&quot;, y = &quot;真陽性率(感度)&quot;)</code></pre>
<p><img src="Logistic_Regression_interaction_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>ROC曲線が対角線より左上にあり、(0, 1)に向かって線が良く伸びていることから、モデルの当てはまりは良さそう。<br />
目視では判断が難しい場合はAUCを算出する。</p>
</div>
<div id="auc-1" class="section level3" number="5.2.2">
<h3 number="5.2.2"><span class="header-section-number">5.2.2</span> AUC</h3>
<pre class="r"><code>auc &lt;- model_2 %&gt;% 
  predict(type = &quot;response&quot;) %&gt;% 
  ROCR::prediction(labels = data$smd == 1) %&gt;% 
  performance(&quot;auc&quot;)

auc@y.values[[1]]</code></pre>
<pre><code>[1] 0.9112912</code></pre>
<p>AUC値は0.5～1までの値を取る。1に近いほどモデルの当てはまりが良い。<br />
今回のモデルのAUCは0.9112912で非常に当てはまりが良い。</p>
</div>
</div>
<div id="実質的な有意性への言及-1" class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> 実質的な有意性への言及</h2>
<div id="限界効果-1" class="section level3" number="5.3.1">
<h3 number="5.3.1"><span class="header-section-number">5.3.1</span> 限界効果</h3>
<pre class="r"><code>margins_2 &lt;- summary(margins(model_2, 
                             at = list(previous = 0:16),
                             type = &quot;link&quot;)) %&gt;% 
  dplyr::filter(factor == &quot;expm&quot;) %&gt;% 
  as.data.frame()</code></pre>
<pre class="r"><code>margins_2 %&gt;% 
  ggplot(aes(x = previous, y = AME)) +
  geom_line() +
  geom_ribbon(aes(ymin = lower, ymax = upper),
                  alpha = .3) +
  geom_hline(yintercept = 0, 
             linetype = 2,
             color = &quot;red&quot;) +
  scale_x_continuous(breaks = seq(0,16, legth = 17)) +
  labs(x = &quot;previous&quot;, 
       y = &quot;previousが当選確率に与える影響（平均限界効果)&quot;,
       title = &quot;限界効果&quot;)</code></pre>
<p><img src="Logistic_Regression_interaction_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>exppvが当選確率に与える影響は、previousが4回までの候補者は統計的に有意であるとわかった。<br />
また、徐々にexpmの影響が小さくなっていき、最終的に影響が無くなるようだ。<br />
新人候補者ほど選挙費用はケチらないほうがよいとわかる。</p>
</div>
<div id="予測確率-1" class="section level3" number="5.3.2">
<h3 number="5.3.2"><span class="header-section-number">5.3.2</span> 予測確率</h3>
<pre class="r"><code>prediction_2_0 &lt;- function(x){
  model_2 %&gt;% 
  predict(newdata = data.frame(expm = min(data$expm):max(data$expm), 
                               previous = x,
                               party_size = 0), 
          se.fit = TRUE) %&gt;% 
    as.data.frame() %&gt;% 
    mutate(ll = fit + qnorm(0.025) * se.fit,
           ul = fit + qnorm(0.975) * se.fit,
           estimate = (1 / (1 + exp(-fit))),
           lower = (1 / (1 + exp(-ll))),
           upper = (1 / (1 + exp(-ul))),
           expm = min(data$expm):max(data$expm),
           previous = x,
           party_size = 0)
}

pred_2_0 &lt;- lapply(X = 0:16, FUN = prediction_2_0) %&gt;% bind_rows()</code></pre>
<pre class="r"><code>prediction_2_1 &lt;- function(x){
  model_2 %&gt;% 
  predict(newdata = data.frame(expm = min(data$expm):max(data$expm), 
                               previous = x,
                               party_size = 1), 
          se.fit = TRUE) %&gt;% 
    as.data.frame() %&gt;% 
    mutate(ll = fit + qnorm(0.025) * se.fit,
           ul = fit + qnorm(0.975) * se.fit,
           estimate = (1 / (1 + exp(-fit))),
           lower = (1 / (1 + exp(-ll))),
           upper = (1 / (1 + exp(-ul))),
           expm = min(data$expm):max(data$expm),
           previous = x,
           party_size = 1)
}

pred_2_1 &lt;- lapply(X = 0:16, FUN = prediction_2_1) %&gt;% bind_rows()</code></pre>
<pre class="r"><code>pred_2 &lt;- bind_rows(pred_2_0, pred_2_1)</code></pre>
<pre class="r"><code>pred_2 %&gt;% 
  ggplot(aes(x = expm, y = estimate,
             fill = as.factor(party_size))) +
  geom_line() +
  geom_ribbon(aes(ymin = lower, ymax = upper),
              alpha =.3,
              show.legend = F) +
  lims(y = c(0, 1)) +
  labs(y = &quot;当選確率の予測値&quot;, title = &quot;予測確率&quot;) +
  facet_wrap(~ previous) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="Logistic_Regression_interaction_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>previousが6を超えるとexpmに関わらず当選確率が高い。<br />
また、previousが7を超えたあたりからexpmの効果が無くなっていることが分かる。</p>
<HR>
<p>この記事のコードをまとめたものは<a href="https://github.com/FruitGranola/R_Logistic_Regression_interaction">Github</a>にあります。</p>
<button>
<a href="index.html">Homeに戻る</a>
</button>
</div>
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkxvZ2lzdGljX1JlZ3Jlc3Npb25faW50ZXJhY3Rpb24iDQpkYXRlOiAiYHIgU3lzLnRpbWUoKWAiDQotLS0NCg0KYGBgez1odG1sfQ0KPHN0eWxlPg0KICANCiAgdGFibGUsIHRkLCB0aCB7DQogICAgYm9yZGVyOiBub25lOw0KICAgIHBhZGRpbmctbGVmdDogMWVtOw0KICAgIHBhZGRpbmctcmlnaHQ6IDFlbTsNCiAgICBtaW4td2lkdGg6IDc1JTsNCiAgICBtYXJnaW4tbGVmdDogYXV0bzsNCiAgICBtYXJnaW4tcmlnaHQ6IGF1dG87DQogICAgbWFyZ2luLXRvcDogMWVtOw0KICAgIG1hcmdpbi1ib3R0b206IDFlbTsNCiAgfQ0KDQo8L3N0eWxlPg0KYGBgDQoNCmBgYHtyLCBpbmNsdWRlPUZBTFNFfQ0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KHdhcm5pbmcgPSBGLA0KICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBGLA0KICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQgPSAiIiwNCiAgICAgICAgICAgICAgICAgICAgICBmaWcuYWxpZ24gPSAiY2VudGVyIikNCmBgYA0KDQojIOS9v+eUqOOBmeOCi+ODkeODg+OCseODvOOCuA0KDQpgYGB7cn0NCiMg5L2/55So44GZ44KL44OR44OD44Kx44O844K4DQoNCmxpYnJhcnkodGlkeXZlcnNlKQ0KbGlicmFyeShwYXRjaHdvcmspDQpsaWJyYXJ5KG1hZ3JpdHRyKQ0KbGlicmFyeShzdGFyZ2F6ZXIpDQpsaWJyYXJ5KFJPQ1IpDQpsaWJyYXJ5KGJyb29tKQ0KbGlicmFyeShtYXJnaW5zKQ0KDQp0aGVtZV9zZXQodGhlbWVfbWluaW1hbChiYXNlX2ZhbWlseSA9IDE1KSkNCg0KIyBnZ3Bsb3QyIOOBriB0aGVtZSDjgpLjgYLjgonjgYvjgZjjgoHoqK3lrprjgZfjgabjgYrjgY8NCg0KdGhlbWVfc2V0KHRoZW1lX21pbmltYWwoYmFzZV9zaXplID0gMTUpKQ0KYGBgDQoNCg0KDQojIOODh+ODvOOCvw0KDQrjg4fjg7zjgr/jga9b44GT44Gh44KJXSguL2RhdGEvSG91c2Vfb2ZfQ291bmNpbG9yc18xOTk2XzIwMTcuY3N2KQ0KDQpgYGB7cn0NCmRhdGEgPC0gcmVhZF9jc3YoIkRhdGEvSG91c2Vfb2ZfQ291bmNpbG9yc18xOTk2XzIwMTcuY3N2IikNCmBgYA0KDQrku4rlm57kvb/nlKjjgZnjgovjg4fjg7zjgr/jga/jgIHnp4Hjga5RaWl0YeOBp+OBr+OBiummtOafk+OBv+OBruihhumZoumBuOODh+ODvOOCv+OBp+OBmeOAgg0KDQoNCg0KIyMg44OH44O844K/44Gu5pON5L2cDQoNCmBgYHtyfQ0KZGF0YSAlPD4lIA0KICBkcGx5cjo6ZmlsdGVyKHllYXIgPT0gMjAwNSkgJT4lIA0KICBkcGx5cjo6bXV0YXRlKCJwYXJ0eV9zaXplIiA9IGlmX2Vsc2UocGFydHlfanBuICVpbiUgYygi6Ieq5rCR5YWaIiwgIuawkeS4u+WFmiIpLCAxLCAwKSkgJT4lICANCiAgZHBseXI6OnNlbGVjdChzbWQsIGV4cG0sIHByZXZpb3VzLCBwYXJ0eV9zaXplKSAlPiUgDQogIGRyb3BfbmEoKSAlPiUgDQogIGFzLmRhdGEuZnJhbWUoKQ0KYGBgDQoNCjIwMDXlubTjga7ooYbpmaLpgbjjgpLlr77osaHjgajjgZfjgb7jgZnjgIIgIA0K44G+44Gf44CB44OA44Of44O85aSJ5pWw44KS5L2c5oiQ44GX44Gm5aSJ5pWw6YG45oqe44KS6KGM44GE44G+44GX44Gf44CCICANCm5h44KS5oyB44Gk5YCL5L2T44Gr6Zai44GX44Gm44Gv44CB5YWo44Gm5o6S6Zmk44GX44G+44GX44Gf44CCDQoNCg0KDQojIyDopoHntITntbHoqIjph48NCg0KYGBge3IsIHJlc3VsdHM9J2FzaXMnfQ0Kc3RhcmdhemVyKGRhdGEsDQogICAgICAgICAgdHlwZSA9ICJodG1sIiwNCiAgICAgICAgICBzdW1tYXJ5LnN0YXQgPSBjKCJuIiwgInNkIiwgIm1pbiIsICJtZWFuIiwgIm1heCIpKQ0KYGBgDQoNCnzlpInmlbDlkI0gICAgfOWGheWuuSAgICB85YKZ6ICDICAgICAgICAgICAgICAgICAgICAgIHwNCnwtLS0tLS0tLS0tfC0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfA0KfHNtZCAgICAgICB85b2T6JC944CAICB8MD3okL3pgbjjgIExPeW9k+mBuCAgICAgICAgICAgIHwNCnxleHBtICAgICAgfOmBuOaMmeiyu+eUqHzljZjkvY06IOeZvuS4h+WGhiAgICAgICAgICAgICAgfA0KfHByZXZpb3VzICB85b2T6YG45Zue5pWwfCAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KfHBhcnR5X3NpemV85pS/5YWa6KaP5qihfDAgPSDjgZ3jga7ku5bjgIExID0g6Ieq5rCR44O75rCR5Li7fA0KDQoNCg0KIyDkuqTlt67poIXjgajjga8NCg0KYGBge3IsIGVjaG89RkFMU0V9DQojIOODgOODn+ODvOWkieaVsA0KZ2xtIDwtIGdsbShzbWQgfiBleHBtICsgcGFydHlfc2l6ZSwgZGF0YSA9IGRhdGEsIGZhbWlseSA9IGJpbm9taWFsKGxpbmsgPSAibG9naXQiKSkNCg0KcHJlZCA8LSB3aXRoKGRhdGEsIGV4cGFuZC5ncmlkKGV4cG0gPSBzZXEobWluKGV4cG0sIG5hLnJtPVRSVUUpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXgoZXhwbSwgbmEucm09VFJVRSksIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aCA9IDEwMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydHlfc2l6ZSA9IGMoMCwxKSkpDQoNCiMjIG11dGF0ZSDjgpLkvb/jgaPjgabjgIHmlrDjgZ/jgarlpInmlbDjgafjgYLjgovkuojmuKzlgKQgKHByZWQpIOOCkuS9nOOCiuioiOeul+OBmeOCiw0KcHJlZCAlPD4lIG11dGF0ZShzbWQgPSBwcmVkaWN0KGdsbSwgdHlwZSA9ICJyZXNwb25zZSIsIG5ld2RhdGEgPSBwcmVkKSkNCg0KIyMg5pWj5biD5Zuz44Gv6Kaz5ris5YCk44Gn5o+P44GN44CB5Zue5biw55u057ea44Gv5LqI5ris5YCkIChwcmVkKSDjgafmj4/jgY8NCnAxIDwtIGdncGxvdChkYXRhLCBhZXMoeCA9IGV4cG0sIHkgPSBzbWQsIGNvbG9yID0gYXMuZmFjdG9yKHBhcnR5X3NpemUpKSkgKw0KICBnZW9tX3BvaW50KHNpemUgPSAxKSArIA0KICBnZW9tX2xpbmUoZGF0YSA9IHByZWQpICsgDQogIGxhYnMoeCA9ICLpgbjmjJnosrvnlKgo55m+5LiH5YaGKSIsIHkgPSAi5b6X56Wo546HKCUpIiwNCiAgICAgICB0aXRsZSA9ICLjg4Djg5/jg7zlpInmlbAiKSArIA0KICBzY2FsZV9jb2xvcl9kaXNjcmV0ZShuYW1lID0gTlVMTCwgbGFiZWxzID0gYygi44Gd44Gu5LuWIiwgIuiHquawkeODu+awkeS4uyIpKSArIA0KICBndWlkZXMoY29sb3IgPSBndWlkZV9sZWdlbmQocmV2ZXJzZSA9IFRSVUUpKSArDQogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iKQ0KYGBgDQoNCmBgYHtyLCBlY2hvPUZBTFNFfQ0KIyDkuqTlt67poIUNCmdsbSA8LSBnbG0oc21kIH4gZXhwbSArIHBhcnR5X3NpemUgKyBleHBtOnBhcnR5X3NpemUsIGRhdGEgPSBkYXRhLCBmYW1pbHkgPSBiaW5vbWlhbChsaW5rID0gImxvZ2l0IikpDQoNCnByZWQgPC0gd2l0aChkYXRhLCBleHBhbmQuZ3JpZChleHBtID0gc2VxKG1pbihleHBtLCBuYS5ybT1UUlVFKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4KGV4cG0sIG5hLnJtPVRSVUUpLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGggPSAxMDApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnR5X3NpemUgPSBjKDAsMSkpKQ0KDQojIyBtdXRhdGUg44KS5L2/44Gj44Gm44CB5paw44Gf44Gq5aSJ5pWw44Gn44GC44KL5LqI5ris5YCkIChwcmVkKSDjgpLkvZzjgoroqIjnrpfjgZnjgosNCnByZWQgJTw+JSBtdXRhdGUoc21kID0gcHJlZGljdChnbG0sIHR5cGUgPSAicmVzcG9uc2UiLCBuZXdkYXRhID0gcHJlZCkpDQoNCiMjIOaVo+W4g+Wbs+OBr+ims+a4rOWApOOBp+aPj+OBjeOAgeWbnuW4sOebtOe3muOBr+S6iOa4rOWApCAocHJlZCkg44Gn5o+P44GPDQpwMiA8LSBnZ3Bsb3QoZGF0YSwgYWVzKHggPSBleHBtLCB5ID0gc21kLCBjb2xvciA9IGFzLmZhY3RvcihwYXJ0eV9zaXplKSkpICsNCiAgZ2VvbV9wb2ludChzaXplID0gMSkgKyANCiAgZ2VvbV9saW5lKGRhdGEgPSBwcmVkKSArIA0KICBsYWJzKHggPSAi6YG45oyZ6LK755SoKOeZvuS4h+WGhikiLCB5ID0gTlVMTCwNCiAgICAgICB0aXRsZSA9ICLkuqTlt67poIUiKSArIA0KICBzY2FsZV9jb2xvcl9kaXNjcmV0ZShuYW1lID0gTlVMTCwgbGFiZWxzID0gYygi44Gd44Gu5LuWIiwgIuiHquawkeODu+awkeS4uyIpKSArIA0KICBndWlkZXMoY29sb3IgPSBndWlkZV9sZWdlbmQocmV2ZXJzZSA9IFRSVUUpKSArDQogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJib3R0b20iKQ0KYGBgDQoNCmBgYHtyLCBlY2hvPUZBTFNFfQ0KcDEgKyBwMg0KYGBgDQoNCuS4iuiomOOBruWbs+OBr+ODgOODn+ODvOWkieaVsOOBqOS6pOW3rumgheOBruWbnuW4sOebtOe3muOBrumBleOBhOOCkuWPr+imluWMluOBl+OBn+OCguOBruOBoOOAgiAgDQrkuqTlt67poIXjgpLkvb/jgYbjgajjgIHoqr/mlbTlpInmlbDjgYzlj5bjgovlgKTjgavjgojjgaPjgabjgIFBTUUo5bmz5Z2H6ZmQ55WM5Yq55p6cKeOBjOeVsOOBquOCi+OBk+OBqOOCkuaNieOBiOOCi+OBk+OBqOOBjOOBp+OBjeOCi+OAgQ0KDQoNCg0KIyDpgKPntprlpInmlbDjgajjgqvjg4bjgrTjg6rjgqvjg6vlpInmlbDjgafjga7kuqTlt67poIUNCg0KIyMg5Lqk5beu6aCF44KS5ZCr44KA6YeN5Zue5biw5YiG5p6QDQoNCmBgYHtyfQ0KbW9kZWxfMSA8LSBnbG0oc21kIH4gZXhwbSArIHByZXZpb3VzICsgcGFydHlfc2l6ZSArIGV4cG06cGFydHlfc2l6ZSwgZGF0YSwgZmFtaWx5ID0gYmlub21pYWwobGluayA9ICJsb2dpdCIpKQ0KYGBgDQoNCmBgYHtyLCByZXN1bHRzPSdhc2lzJ30NCnN0YXJnYXplcihtb2RlbF8xLA0KICAgICAgICAgIHR5cGUgPSAiaHRtbCIsDQogICAgICAgICAgc3R5bGUgPSAiYWxsMiIsDQogICAgICAgICAgZGlnaXRzID0gMiwgDQogICAgICAgICAgYWxpZ24gPSBULCAjIOS4reWkruaPg+OBiA0KICAgICAgICAgIGtlZXAuc3RhdCA9IGMoIm4iLCAiYWRqLnJzcSIsICJmIikpDQpgYGANCg0K44GT44Gu44G+44G+44Gn44Gv6Kej6YeI44GM6Zuj44GX44GE44Gu44Gn44CB5Lul5LiL44Gu44KI44GG44Gr44Kq44OD44K644Go5b2T6YG456K6546H44KS6KiI566X44GZ44KL44CCICANCuOBk+OBhuOBmeOCi+OBk+OBqOOBp+OAgeWIhuaekOe1kOaenOOBruino+mHiOOCkuWPr+iDveOBq+OBmeOCi+OAgg0KDQoNCg0KIyMjIOOCquODg+OCuuavlA0KDQpgYGB7cn0NCmV4cChtb2RlbF8xJGNvZWZmaWNpZW50cykNCmBgYA0KDQpDb25zdGFudDog5YWo6Kqs5piO5aSJ5pWw44GMMOOBruaZguOBq+OAjOW/nOetlOWkieaVsOOBjDHjgavjgarjgovjgI3jgqrjg4PjgroNCg0KZXN0aW1hdGU6IOS7luOBruiqrOaYjuWkieaVsOOCkuW5s+Wdh+WApOOBp+WbuuWumuOBl+OAgeWkieaVsOOCkjHljZjkvY3lopfjgoTjgZfjgZ/jgajjgY3jgavjgIzlv5znrZTlpInmlbDjgYwx44Gr44Gq44KL44CN44Kq44OD44K6DQoNCg0KDQojIyMg5b2T6YG456K6546HDQoNCmBgYHtyfQ0KMSAvICgxICsgZXhwKC1tb2RlbF8xJGNvZWZmaWNpZW50cykpDQpgYGANCg0KZXN0aW1hdGU6IOS7luOBruiqrOaYjuWkieaVsOOCkuW5s+Wdh+WApOOBp+WbuuWumuOBl+OAgeOBneOBruWkieaVsOOCkjHljZjkvY3lopfjgoTjgZfjgZ/jgajjgY3jgavjgIzlv5znrZTlpInmlbDjgYwx44Gr44Gq44KL44CN56K6546HDQoNCuOBk+OBruOCiOOBhuOBq+OCquODg+OCuuOChOeiuueOh+OBq+WkieaPm+OBmeOCi+OBk+OBqOOBp+OAgeino+mHiOWPr+iDveaAp+OCkuS4iuOBkuOCi+OBk+OBqOOBjOOBp+OBjeOCi+OBjOOAgQ0K44GT44KM44Gn44KC44G+44Gg44CB55u05oSf55qE44Gr55CG6Kej44GZ44KL44GT44Go44Gv6Zuj44GX44GE44CC44Gd44Gu44Gf44KB44CB6ZmQ55WM5Yq55p6c44KE5b2T6YG456K6546H44Gu5Y+v6KaW5YyW44GM6YeN6KaB44Gr44Gq44KL44CCDQoNCg0KDQojIyDjg6Ljg4fjg6vjga7oqZXkvqENCg0KIyMjIFJPQ+absue3mg0KDQpgYGB7cn0NCnJvYyA8LSBtb2RlbF8xICU+JSANCiAgcHJlZGljdCh0eXBlID0gInJlc3BvbnNlIikgJT4lIA0KICBST0NSOjpwcmVkaWN0aW9uKGxhYmVscyA9IGRhdGEkc21kID09IDEpICU+JSANCiAgcGVyZm9ybWFuY2UoInRwciIsICJmcHIiKSANCg0KZGZfcm9jIDwtIGRhdGEuZnJhbWUodHByID0gcm9jQHkudmFsdWVzW1sxXV0sIGZwciA9IHJvY0B4LnZhbHVlc1tbMV1dKQ0KDQpnZ3Bsb3QoZGZfcm9jLCBhZXMoeCA9IGZwciwgeSA9IHRwcikpICsgDQogIGdlb21fbGluZShjb2xvciA9ICJyZWQiKSArDQogIGdlb21fYWJsaW5lKGludGVyY2VwdCA9IDAsIHNsb3BlID0gMSwgbGluZXR5cGUgPSAiZGFzaGVkIikgKw0KICBzY2FsZV9saW5ldHlwZV9kaXNjcmV0ZShuYW1lID0gIiIpICsNCiAgc2NhbGVfY29sb3JfZGlzY3JldGUobmFtZSA9ICIiKSArDQogIGNvb3JkX2ZpeGVkKCkgKw0KICBsYWJzKHggPSAi5YG96Zm95oCn546HKDEgLSDnibnnlbDluqYpIiwgeSA9ICLnnJ/pmb3mgKfnjoco5oSf5bqmKSIpDQpgYGANCg0KUk9D5puy57ea44GM5a++6KeS57ea44KI44KK5bem5LiK44Gr44GC44KK44CBKDAsIDEp44Gr5ZCR44GL44Gj44Gm57ea44GM6Imv44GP5Ly444Gz44Gm44GE44KL44GT44Go44GL44KJ44CB44Oi44OH44Or44Gu5b2T44Gm44Gv44G+44KK44Gv6Imv44GV44Gd44GG44CCICANCuebruimluOBp+OBr+WIpOaWreOBjOmbo+OBl+OBhOWgtOWQiOOBr0FVQ+OCkueul+WHuuOBmeOCi+OAgg0KDQoNCg0KIyMjIEFVQw0KDQpgYGB7cn0NCmF1YyA8LSBtb2RlbF8xICU+JSANCiAgcHJlZGljdCh0eXBlID0gInJlc3BvbnNlIikgJT4lIA0KICBST0NSOjpwcmVkaWN0aW9uKGxhYmVscyA9IGRhdGEkc21kID09IDEpICU+JSANCiAgcGVyZm9ybWFuY2UoImF1YyIpDQoNCmF1Y0B5LnZhbHVlc1tbMV1dDQpgYGANCg0KQVVD5YCk44GvMC41772eMeOBvuOBp+OBruWApOOCkuWPluOCi+OAgjHjgavov5HjgYTjgbvjganjg6Ljg4fjg6vjga7lvZPjgabjga/jgb7jgorjgYzoia/jgYTjgIIgIA0K5LuK5Zue44Gu44Oi44OH44Or44GuQVVD44GvMC45MTQzMDXjgafpnZ7luLjjgavlvZPjgabjga/jgb7jgorjgYzoia/jgYTjgIINCg0KDQoNCiMjIOWun+izqueahOOBquacieaEj+aAp+OBuOOBruiogOWPig0KDQojIyMg6ZmQ55WM5Yq55p6cDQoNCmBgYHtyfQ0KbWFyZ2luc18xIDwtIHN1bW1hcnkobWFyZ2lucyhtb2RlbF8xLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXQgPSBsaXN0KHBhcnR5X3NpemUgPSAwOjEpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gImxpbmsiKSkgJT4lIA0KICBkcGx5cjo6ZmlsdGVyKGZhY3RvciA9PSAiZXhwbSIpICU+JSANCiAgYXMuZGF0YS5mcmFtZSgpDQpgYGANCg0KYGBge3J9DQptYXJnaW5zXzEgJT4lIA0KICBnZ3Bsb3QoYWVzKHggPSBwYXJ0eV9zaXplLCB5ID0gQU1FKSkgKw0KICBnZW9tX3BvaW50cmFuZ2UoYWVzKHltaW4gPSBsb3dlciwgeW1heCA9IHVwcGVyLA0KICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gYXMuZmFjdG9yKHBhcnR5X3NpemUpKSwNCiAgICAgICAgICAgICAgICAgIHNpemUgPSAyLA0KICAgICAgICAgICAgICAgICAgc2hvdy5sZWdlbmQgPSBGKSArDQogIGdlb21faGxpbmUoeWludGVyY2VwdCA9IDAsIA0KICAgICAgICAgICAgIGxpbmV0eXBlID0gMiwNCiAgICAgICAgICAgICBjb2xvciA9ICJyZWQiKSArDQogIGdlb21fdGV4dChhZXMobGFiZWwgPSByb3VuZChBTUUsIDIpKSwNCiAgICAgICAgICAgIGhqdXN0ID0gMikgKw0KICBzY2FsZV94X2NvbnRpbnVvdXMoYnJlYWtzID0gYygwLCAxKSwgDQogICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBjKCIwIiwgIjEiKSkgKw0KICBsYWJzKHggPSBOVUxMLCANCiAgICAgICB5ID0gImV4cG3jgYx2b3Rlc2hhcmXjgavkuI7jgYjjgovlvbHpn7/vvIjpmZDnlYzlirnmnpwpIiwNCiAgICAgICB0aXRsZSA9ICLpmZDnlYzlirnmnpwiKSArDQogIGNvb3JkX3RyYW5zKHhsaW0gPSBjKC0wLjUsIDEuNSkpDQpgYGANCg0K6KGo44Gn44Gv6Kej6YeI44GM6Zuj44GX44GL44Gj44Gf44GM44CB44GT44Gu44KI44GG44Gr5Zuz44Gr6KGo44GZ44Go5YiG44GL44KK44KE44GZ44GE44Gg44KN44GG44CCICANCuS4oeaWueOBqOOCgui1pOOBhOeCuee3muOCkui3qOOBhOOBp+OBhOOBquOBhOOBk+OBqOOBi+OCieOAgSAgDQroqr/mlbTlpInmlbDjga7lgKTjgavjgojjgaPjgaZleHBt44GM5b2T6YG456K6546H44Gr5LiO44GI44KL5b2x6Z+/44GM55Ww44Gq44KL44GT44Go44GM57Wx6KiI55qE44Gr5pyJ5oSP44Gn44GC44Gj44Gf44Go44KP44GL44Gj44Gf44CCICANCmV4cG3jgYwx5Y2Y5L2N5aKX5Yqg44GZ44KL44Go44CBcGFydHlfc2l6ZeOBjDDjga7loLTlkIjjga/lubPlnYfjgZfjgaYwLjI0JXB044CBcGFydHlfc2l6ZeOBjDHjga7loLTlkIjjga/lubPlnYfjgZfjgaYwLjElcHTlopfliqDjgZnjgovjgIINCg0KDQoNCiMjIyDkuojmuKznorrnjocNCg0KYGBge3J9DQpwcmVkaWN0aW9uXzEgPC0gZnVuY3Rpb24oeCl7DQogIG1vZGVsXzEgJT4lIA0KICBwcmVkaWN0KG5ld2RhdGEgPSBkYXRhLmZyYW1lKGV4cG0gPSBtaW4oZGF0YSRleHBtKTptYXgoZGF0YSRleHBtKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMgPSBtZWFuKGRhdGEkcHJldmlvdXMpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnR5X3NpemUgPSB4KSwgDQogICAgICAgICAgc2UuZml0ID0gVFJVRSkgJT4lIA0KICAgIGFzLmRhdGEuZnJhbWUoKSAlPiUgDQogICAgbXV0YXRlKGxsID0gZml0ICsgcW5vcm0oMC4wMjUpICogc2UuZml0LA0KICAgICAgICAgICB1bCA9IGZpdCArIHFub3JtKDAuOTc1KSAqIHNlLmZpdCwNCiAgICAgICAgICAgZXN0aW1hdGUgPSAoMSAvICgxICsgZXhwKC1maXQpKSksDQogICAgICAgICAgIGxvd2VyID0gKDEgLyAoMSArIGV4cCgtbGwpKSksDQogICAgICAgICAgIHVwcGVyID0gKDEgLyAoMSArIGV4cCgtdWwpKSksDQogICAgICAgICAgIGV4cG0gPSBtaW4oZGF0YSRleHBtKTptYXgoZGF0YSRleHBtKSwNCiAgICAgICAgICAgcGFydHlfc2l6ZSA9IHgpDQp9DQoNCnByZWRfMSA8LSBsYXBwbHkoWCA9IDA6MSwgRlVOID0gcHJlZGljdGlvbl8xKQ0KDQpwcmVkXzEgJTw+JSBiaW5kX3Jvd3MocHJlZF8xWzFdLCBwcmVkXzFbMl0pDQoNCnByZWRfMSAlPiUgDQogIGdncGxvdChhZXMoeCA9IGV4cG0sIHkgPSBlc3RpbWF0ZSwgDQogICAgICAgICAgICAgZmlsbCA9IGFzLmZhY3RvcihwYXJ0eV9zaXplKSkpICsNCiAgZ2VvbV9saW5lKCkgKw0KICBnZW9tX3JpYmJvbihhZXMoeW1pbiA9IGxvd2VyLCB5bWF4ID0gdXBwZXIpLA0KICAgICAgICAgICAgICBhbHBoYSA9LjMsDQogICAgICAgICAgICAgIHNob3cubGVnZW5kID0gRikgKw0KICBsaW1zKHkgPSBjKDAsIDEpKSArDQogIGxhYnMoeSA9ICJ2b3Rlc2hhcmXjga7kuojmuKzlgKQiLCB0aXRsZSA9ICLkuojmuKznorrnjociKSArDQogIGZhY2V0X3dyYXAofiBwYXJ0eV9zaXplLA0KICAgICAgICAgICAgIGxhYmVsbGVyID0gYXNfbGFiZWxsZXIoYyhgMGAgPSAi44Gd44Gu5LuWIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYDFgID0gIuiHquawkeODu+awkeS4uyIpKSkgDQpgYGANCg0KZXhwbeOBjOWil+WKoOOBmeOCi+OBqOOAgeW9k+mBuOeiuueOh+OCguWil+WKoOOBmeOCi+OAguOBvuOBn+OAgeOBneOBruS7luOBruaUv+WFmuOBruOBu+OBhuOBjGV4cG3jgYzkuIrmmIfjgZfjgZ/pmpvjga7lvZPpgbjnorrnjofjga7kuIrjgYzjgormlrnjgYzpoZXokZfjgafjgYLjgovjgIIgIA0K44Gd44Gu5LuW44Gu5pS/5YWa44Gu5aC05ZCI44CBZXhwcG3jgYwxMOOCkui2heOBiOOBn+OBguOBn+OCiuOBi+OCieaApea/gOOBq+W9semfv+OBjOW8t+OBj+OBquOCi+OCiOOBhuOBoOOAgiAgDQrjgZ/jgaDjgIHlvZPpgbjnorrnjofjgYw1MCXjgavjgarjgovjga7jga/oh6rmsJHjg7vmsJHkuLvjga7jgbvjgYbjgYzml6njgYTjgILjgZPjga7jgZPjgajjgYvjgonjgIHoh6rmsJHjg7vmsJHkuLvjga7lgJnoo5zogIXjga/jgojjgorlronkvqHjgavlvZPpgbjjgYzni5njgYjjgovjgojjgYbjgaDjgIINCg0KDQoNCiMg6YCj57aa5aSJ5pWw44Go6YCj57aa5aSJ5pWw44Gn44Gu5Lqk5beu6aCFDQoNCiMjIOS6pOW3rumgheOCkuWQq+OCgOmHjeWbnuW4sOWIhuaekA0KDQpgYGB7cn0NCm1vZGVsXzIgPC0gZ2xtKHNtZCB+IGV4cG0gKyBwcmV2aW91cyArIHBhcnR5X3NpemUgKyBleHBtOnByZXZpb3VzLCBkYXRhLCBmYW1pbHkgPSBiaW5vbWlhbChsaW5rID0gImxvZ2l0IikpDQpgYGANCg0KYGBge3IsIHJlc3VsdHM9J2FzaXMnfQ0Kc3RhcmdhemVyKG1vZGVsXzIsDQogICAgICAgICAgdHlwZSA9ICJodG1sIiwNCiAgICAgICAgICBzdHlsZSA9ICJhbGwyIiwNCiAgICAgICAgICBkaWdpdHMgPSAyLCANCiAgICAgICAgICBhbGlnbiA9IFQsICMg5Lit5aSu5o+D44GIDQogICAgICAgICAga2VlcC5zdGF0ID0gYygibiIsICJhZGoucnNxIiwgImYiKSkNCmBgYA0KDQrjgZPjga7jgb7jgb7jgafjga/op6Pph4jjgafjgY3jgarjgYTjga7jgafjgIHku6XkuIvjga7jgojjgYbjgavjgqrjg4PjgrrjgajlvZPpgbjnorrnjofjgpLoqIjnrpfjgZnjgovjgIIgIA0K44GT44GG44GZ44KL44GT44Go44Gn44CB5YiG5p6Q57WQ5p6c44Gu6Kej6YeI44KS5Y+v6IO944Gr44GZ44KL44CCDQoNCiMjIyDjgqrjg4Pjgrrmr5QNCg0KYGBge3J9DQpleHAobW9kZWxfMiRjb2VmZmljaWVudHMpDQpgYGANCg0KQ29uc3RhbnQ6IOWFqOiqrOaYjuWkieaVsOOBjDDjga7mmYLjgavjgIzlv5znrZTlpInmlbDjgYwx44Gr44Gq44KL44CN44Kq44OD44K6DQoNCmVzdGltYXRlOiDku5bjga7oqqzmmI7lpInmlbDjgpLlubPlnYflgKTjgaflm7rlrprjgZfjgIHlpInmlbDjgpIx5Y2Y5L2N5aKX44KE44GX44Gf44Go44GN44Gr44CM5b+c562U5aSJ5pWw44GMMeOBq+OBquOCi+OAjeOCquODg+OCug0KDQoNCg0KIyMjIOW9k+mBuOeiuueOhw0KDQpgYGB7cn0NCjEgLyAoMSArIGV4cCgtbW9kZWxfMiRjb2VmZmljaWVudHMpKQ0KYGBgDQoNCmVzdGltYXRlOiDku5bjga7oqqzmmI7lpInmlbDjgpLlubPlnYflgKTjgaflm7rlrprjgZfjgIHjgZ3jga7lpInmlbDjgpIx5Y2Y5L2N5aKX44KE44GX44Gf44Go44GN44Gr44CM5b+c562U5aSJ5pWw44GMMeOBq+OBquOCi+OAjeeiuueOhw0KDQrjgZPjga7jgojjgYbjgavjgqrjg4PjgrrjgoTnorrnjofjgavlpInmj5vjgZnjgovjgZPjgajjgafjgIHop6Pph4jlj6/og73mgKfjgpLkuIrjgZLjgovjgZPjgajjgYzjgafjgY3jgovjgYzjgIENCuOBk+OCjOOBp+OCguOBvuOBoOOAgeebtOaEn+eahOOBq+eQhuino+OBmeOCi+OBk+OBqOOBr+mbo+OBl+OBhOOAguOBneOBruOBn+OCgeOAgemZkOeVjOWKueaenOOChOW9k+mBuOeiuueOh+OBruWPr+imluWMluOBjOmHjeimgeOBq+OBquOCi+OAgg0KDQoNCg0KIyMg44Oi44OH44Or44Gu6KmV5L6hDQoNCiMjIyBST0Pmm7Lnt5oNCg0KYGBge3J9DQpyb2MgPC0gbW9kZWxfMiAlPiUgDQogIHByZWRpY3QodHlwZSA9ICJyZXNwb25zZSIpICU+JSANCiAgUk9DUjo6cHJlZGljdGlvbihsYWJlbHMgPSBkYXRhJHNtZCA9PSAxKSAlPiUgDQogIHBlcmZvcm1hbmNlKCJ0cHIiLCAiZnByIikgDQoNCmRmX3JvYyA8LSBkYXRhLmZyYW1lKHRwciA9IHJvY0B5LnZhbHVlc1tbMV1dLCBmcHIgPSByb2NAeC52YWx1ZXNbWzFdXSkNCg0KZ2dwbG90KGRmX3JvYywgYWVzKHggPSBmcHIsIHkgPSB0cHIpKSArIA0KICBnZW9tX2xpbmUoY29sb3IgPSAicmVkIikgKw0KICBnZW9tX2FibGluZShpbnRlcmNlcHQgPSAwLCBzbG9wZSA9IDEsIGxpbmV0eXBlID0gImRhc2hlZCIpICsNCiAgc2NhbGVfbGluZXR5cGVfZGlzY3JldGUobmFtZSA9ICIiKSArDQogIHNjYWxlX2NvbG9yX2Rpc2NyZXRlKG5hbWUgPSAiIikgKw0KICBjb29yZF9maXhlZCgpICsNCiAgbGFicyh4ID0gIuWBvemZveaAp+eOhygxIC0g54m555Ww5bqmKSIsIHkgPSAi55yf6Zm95oCn546HKOaEn+W6pikiKQ0KYGBgDQoNClJPQ+absue3muOBjOWvvuinkue3muOCiOOCiuW3puS4iuOBq+OBguOCiuOAgSgwLCAxKeOBq+WQkeOBi+OBo+OBpue3muOBjOiJr+OBj+S8uOOBs+OBpuOBhOOCi+OBk+OBqOOBi+OCieOAgeODouODh+ODq+OBruW9k+OBpuOBr+OBvuOCiuOBr+iJr+OBleOBneOBhuOAgiAgDQrnm67oppbjgafjga/liKTmlq3jgYzpm6PjgZfjgYTloLTlkIjjga9BVUPjgpLnrpflh7rjgZnjgovjgIINCg0KIyMjIEFVQw0KDQpgYGB7cn0NCmF1YyA8LSBtb2RlbF8yICU+JSANCiAgcHJlZGljdCh0eXBlID0gInJlc3BvbnNlIikgJT4lIA0KICBST0NSOjpwcmVkaWN0aW9uKGxhYmVscyA9IGRhdGEkc21kID09IDEpICU+JSANCiAgcGVyZm9ybWFuY2UoImF1YyIpDQoNCmF1Y0B5LnZhbHVlc1tbMV1dDQpgYGANCg0KQVVD5YCk44GvMC41772eMeOBvuOBp+OBruWApOOCkuWPluOCi+OAgjHjgavov5HjgYTjgbvjganjg6Ljg4fjg6vjga7lvZPjgabjga/jgb7jgorjgYzoia/jgYTjgIIgIA0K5LuK5Zue44Gu44Oi44OH44Or44GuQVVD44GvMC45MTEyOTEy44Gn6Z2e5bi444Gr5b2T44Gm44Gv44G+44KK44GM6Imv44GE44CCDQoNCg0KIyMg5a6f6LOq55qE44Gq5pyJ5oSP5oCn44G444Gu6KiA5Y+KDQoNCiMjIyDpmZDnlYzlirnmnpwNCg0KYGBge3J9DQptYXJnaW5zXzIgPC0gc3VtbWFyeShtYXJnaW5zKG1vZGVsXzIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdCA9IGxpc3QocHJldmlvdXMgPSAwOjE2KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICJsaW5rIikpICU+JSANCiAgZHBseXI6OmZpbHRlcihmYWN0b3IgPT0gImV4cG0iKSAlPiUgDQogIGFzLmRhdGEuZnJhbWUoKQ0KYGBgDQoNCmBgYHtyfQ0KbWFyZ2luc18yICU+JSANCiAgZ2dwbG90KGFlcyh4ID0gcHJldmlvdXMsIHkgPSBBTUUpKSArDQogIGdlb21fbGluZSgpICsNCiAgZ2VvbV9yaWJib24oYWVzKHltaW4gPSBsb3dlciwgeW1heCA9IHVwcGVyKSwNCiAgICAgICAgICAgICAgICAgIGFscGhhID0gLjMpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgDQogICAgICAgICAgICAgbGluZXR5cGUgPSAyLA0KICAgICAgICAgICAgIGNvbG9yID0gInJlZCIpICsNCiAgc2NhbGVfeF9jb250aW51b3VzKGJyZWFrcyA9IHNlcSgwLDE2LCBsZWd0aCA9IDE3KSkgKw0KICBsYWJzKHggPSAicHJldmlvdXMiLCANCiAgICAgICB5ID0gInByZXZpb3Vz44GM5b2T6YG456K6546H44Gr5LiO44GI44KL5b2x6Z+/77yI5bmz5Z2H6ZmQ55WM5Yq55p6cKSIsDQogICAgICAgdGl0bGUgPSAi6ZmQ55WM5Yq55p6cIikNCmBgYA0KDQpleHBwduOBjOW9k+mBuOeiuueOh+OBq+S4juOBiOOCi+W9semfv+OBr+OAgXByZXZpb3Vz44GMNOWbnuOBvuOBp+OBruWAmeijnOiAheOBr+e1seioiOeahOOBq+acieaEj+OBp+OBguOCi+OBqOOCj+OBi+OBo+OBn+OAgiAgDQrjgb7jgZ/jgIHlvpDjgIXjgatleHBt44Gu5b2x6Z+/44GM5bCP44GV44GP44Gq44Gj44Gm44GE44GN44CB5pyA57WC55qE44Gr5b2x6Z+/44GM54Sh44GP44Gq44KL44KI44GG44Gg44CCICANCuaWsOS6uuWAmeijnOiAheOBu+OBqemBuOaMmeiyu+eUqOOBr+OCseODgeOCieOBquOBhOOBu+OBhuOBjOOCiOOBhOOBqOOCj+OBi+OCi+OAgg0KDQoNCg0KIyMjIOS6iOa4rOeiuueOhw0KDQpgYGB7cn0NCnByZWRpY3Rpb25fMl8wIDwtIGZ1bmN0aW9uKHgpew0KICBtb2RlbF8yICU+JSANCiAgcHJlZGljdChuZXdkYXRhID0gZGF0YS5mcmFtZShleHBtID0gbWluKGRhdGEkZXhwbSk6bWF4KGRhdGEkZXhwbSksIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpb3VzID0geCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0eV9zaXplID0gMCksIA0KICAgICAgICAgIHNlLmZpdCA9IFRSVUUpICU+JSANCiAgICBhcy5kYXRhLmZyYW1lKCkgJT4lIA0KICAgIG11dGF0ZShsbCA9IGZpdCArIHFub3JtKDAuMDI1KSAqIHNlLmZpdCwNCiAgICAgICAgICAgdWwgPSBmaXQgKyBxbm9ybSgwLjk3NSkgKiBzZS5maXQsDQogICAgICAgICAgIGVzdGltYXRlID0gKDEgLyAoMSArIGV4cCgtZml0KSkpLA0KICAgICAgICAgICBsb3dlciA9ICgxIC8gKDEgKyBleHAoLWxsKSkpLA0KICAgICAgICAgICB1cHBlciA9ICgxIC8gKDEgKyBleHAoLXVsKSkpLA0KICAgICAgICAgICBleHBtID0gbWluKGRhdGEkZXhwbSk6bWF4KGRhdGEkZXhwbSksDQogICAgICAgICAgIHByZXZpb3VzID0geCwNCiAgICAgICAgICAgcGFydHlfc2l6ZSA9IDApDQp9DQoNCnByZWRfMl8wIDwtIGxhcHBseShYID0gMDoxNiwgRlVOID0gcHJlZGljdGlvbl8yXzApICU+JSBiaW5kX3Jvd3MoKQ0KYGBgDQoNCmBgYHtyfQ0KcHJlZGljdGlvbl8yXzEgPC0gZnVuY3Rpb24oeCl7DQogIG1vZGVsXzIgJT4lIA0KICBwcmVkaWN0KG5ld2RhdGEgPSBkYXRhLmZyYW1lKGV4cG0gPSBtaW4oZGF0YSRleHBtKTptYXgoZGF0YSRleHBtKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMgPSB4LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnR5X3NpemUgPSAxKSwgDQogICAgICAgICAgc2UuZml0ID0gVFJVRSkgJT4lIA0KICAgIGFzLmRhdGEuZnJhbWUoKSAlPiUgDQogICAgbXV0YXRlKGxsID0gZml0ICsgcW5vcm0oMC4wMjUpICogc2UuZml0LA0KICAgICAgICAgICB1bCA9IGZpdCArIHFub3JtKDAuOTc1KSAqIHNlLmZpdCwNCiAgICAgICAgICAgZXN0aW1hdGUgPSAoMSAvICgxICsgZXhwKC1maXQpKSksDQogICAgICAgICAgIGxvd2VyID0gKDEgLyAoMSArIGV4cCgtbGwpKSksDQogICAgICAgICAgIHVwcGVyID0gKDEgLyAoMSArIGV4cCgtdWwpKSksDQogICAgICAgICAgIGV4cG0gPSBtaW4oZGF0YSRleHBtKTptYXgoZGF0YSRleHBtKSwNCiAgICAgICAgICAgcHJldmlvdXMgPSB4LA0KICAgICAgICAgICBwYXJ0eV9zaXplID0gMSkNCn0NCg0KcHJlZF8yXzEgPC0gbGFwcGx5KFggPSAwOjE2LCBGVU4gPSBwcmVkaWN0aW9uXzJfMSkgJT4lIGJpbmRfcm93cygpDQpgYGANCg0KYGBge3J9DQpwcmVkXzIgPC0gYmluZF9yb3dzKHByZWRfMl8wLCBwcmVkXzJfMSkNCmBgYA0KDQpgYGB7cn0NCnByZWRfMiAlPiUgDQogIGdncGxvdChhZXMoeCA9IGV4cG0sIHkgPSBlc3RpbWF0ZSwNCiAgICAgICAgICAgICBmaWxsID0gYXMuZmFjdG9yKHBhcnR5X3NpemUpKSkgKw0KICBnZW9tX2xpbmUoKSArDQogIGdlb21fcmliYm9uKGFlcyh5bWluID0gbG93ZXIsIHltYXggPSB1cHBlciksDQogICAgICAgICAgICAgIGFscGhhID0uMywNCiAgICAgICAgICAgICAgc2hvdy5sZWdlbmQgPSBGKSArDQogIGxpbXMoeSA9IGMoMCwgMSkpICsNCiAgbGFicyh5ID0gIuW9k+mBuOeiuueOh+OBruS6iOa4rOWApCIsIHRpdGxlID0gIuS6iOa4rOeiuueOhyIpICsNCiAgZmFjZXRfd3JhcCh+IHByZXZpb3VzKSArDQogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIikNCmBgYA0KDQpwcmV2aW91c+OBjDbjgpLotoXjgYjjgovjgahleHBt44Gr6Zai44KP44KJ44Ga5b2T6YG456K6546H44GM6auY44GE44CCICANCuOBvuOBn+OAgXByZXZpb3Vz44GMN+OCkui2heOBiOOBn+OBguOBn+OCiuOBi+OCiWV4cG3jga7lirnmnpzjgYznhKHjgY/jgarjgaPjgabjgYTjgovjgZPjgajjgYzliIbjgYvjgovjgIINCg0KDQoNCjxIUj4NCg0K44GT44Gu6KiY5LqL44Gu44Kz44O844OJ44KS44G+44Go44KB44Gf44KC44Gu44GvW0dpdGh1Yl0oaHR0cHM6Ly9naXRodWIuY29tL0ZydWl0R3Jhbm9sYS9SX0xvZ2lzdGljX1JlZ3Jlc3Npb25faW50ZXJhY3Rpb24p44Gr44GC44KK44G+44GZ44CCDQoNCjxidXR0b24+W0hvbWXjgavmiLvjgotdKGluZGV4Lmh0bWwpPC9idXR0b24+DQo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Logistic_Regression_interaction.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
