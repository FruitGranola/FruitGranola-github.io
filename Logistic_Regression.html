<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Logistic_Regression</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Sort Horiiのメモ帳</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Data Visualization</li>
    <li>
      <a href="Barplot.html">Barplot</a>
    </li>
    <li>
      <a href="Histogram.html">Histogram</a>
    </li>
    <li>
      <a href="Boxplot.html">Boxplot</a>
    </li>
    <li>
      <a href="Scatterplot.html">Scatterplot</a>
    </li>
    <li>
      <a href="Lineplot.html">Lineplot</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Regression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Regression</li>
    <li>
      <a href="Multiple_Linear_Regression.html">Multiple Linear Regression</a>
    </li>
    <li>
      <a href="Multiple_Linear_Regression_interaction.html">Multiple Linear Regression interaction</a>
    </li>
    <li>
      <a href="Logistic_Regression.html">Logistic Regression</a>
    </li>
    <li>
      <a href="Logistic_Regression_interaction.html">Logistic Regression interaction</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Logistic_Regression</h1>
<h4 class="date">2021-02-21 11:54:00</h4>

</div>


<style>
  
  table, td, th {
    border: none;
    padding-left: 1em;
    padding-right: 1em;
    min-width: 75%;
    margin-left: auto;
    margin-right: auto;
    margin-top: 1em;
    margin-bottom: 1em;
  }

</style>
<div id="使用するパッケージ" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> 使用するパッケージ</h1>
<pre class="r"><code>library(tidyverse)
library(magrittr)
library(stargazer)
library(ROCR)
library(broom)
library(margins)

theme_set(theme_minimal(base_family = 15))</code></pre>
</div>
<div id="使用するデータ" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> 使用するデータ</h1>
<p>データは<a href="./data/House_of_Councilors_1996_2017.csv">こちら</a></p>
<pre class="r"><code>data &lt;- read_csv(&quot;Data/House_of_Councilors_1996_2017.csv&quot;)</code></pre>
<pre class="r"><code>data %&lt;&gt;% 
  filter(year == 2005) %&gt;% 
  mutate(&quot;ldp&quot; = if_else(party_jpn %in%  c(&quot;自民党&quot;), 1, 0)) %&gt;% 
  drop_na() %&gt;% 
  as.data.frame()</code></pre>
</div>
<div id="分析をする流れ" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> 分析をする流れ</h1>
<ol style="list-style-type: decimal">
<li>分析の目的を設定する<br />
</li>
<li>理論と仮説<br />
</li>
<li>変数選択<br />
3-1.従属変数を設定<br />
3-2. 独立変数の設定<br />
</li>
<li>ロジスティック帰分析<br />
4-1. ロジスティック回帰分析の実行<br />
4-2. モデルの診断<br />
4-3. 点・区間推定の可視化<br />
4-4. 予測確率・限界効果の可視化<br />
</li>
<li>分析結果の解釈</li>
</ol>
</div>
<div id="分析の目的を設定する" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> 分析の目的を設定する</h1>
<p>ロジスティック回帰分析を使って分析をする場合は2値変数が従属変数になる現象を探す必要がある。 計量政治学の世界では選挙の当選・落選を0、1で表現し、ロジスティック回帰分析を行うことがよくある。</p>
<p>今回は選挙研究を事例にロジスティック回帰分析の流れを紹介する。 そのうえで、「選挙の当落結果に選挙費用が与える影響」を推定することを目的とする。</p>
</div>
<div id="理論と仮説" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> 理論と仮説</h1>
<p>変数選択をする際は、リサーチクエスチョンからどのような理論を立てられるのか。 そして、この理論を実証するには、どのような仮説を立てて検証するべきかを考える必要がある。 そのため、理論と仮説の設定がとても重要だ。</p>
<blockquote>
<p>理論:<br />
選挙に金をかけると「スタッフの増員」・「選挙カーの使用」などが可能になり、当選確率が高くなる</p>
</blockquote>
<p>上記の理論が正しければ、以下のような仮説が立てられる。</p>
<blockquote>
<p>仮説:<br />
選挙費用が多ければ多いほど、当選確率が高い</p>
</blockquote>
</div>
<div id="変数選択" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> 変数選択</h1>
<pre class="r"><code># 要約統計量をHTMLで出力する。
# チャンクオプションにresults=&#39;asis&#39;を忘れないように

data %&gt;% 
  stargazer(type = &quot;html&quot;,
            summary.stat = c(&quot;n&quot;, &quot;sd&quot;, &quot;min&quot;, &quot;mean&quot;, &quot;max&quot;), 
            title = &quot;要約統計量&quot;,
            align = T)</code></pre>
<table style="text-align:center">
<caption>
<strong>要約統計量</strong>
</caption>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Mean
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
year
</td>
<td>
985
</td>
<td>
0.000
</td>
<td>
2,005
</td>
<td>
2,005.000
</td>
<td>
2,005
</td>
</tr>
<tr>
<td style="text-align:left">
kun
</td>
<td>
985
</td>
<td>
4.924
</td>
<td>
1
</td>
<td>
5.564
</td>
<td>
25
</td>
</tr>
<tr>
<td style="text-align:left">
status
</td>
<td>
985
</td>
<td>
0.588
</td>
<td>
0
</td>
<td>
0.516
</td>
<td>
2
</td>
</tr>
<tr>
<td style="text-align:left">
party_code
</td>
<td>
985
</td>
<td>
24.728
</td>
<td>
1
</td>
<td>
9.497
</td>
<td>
100
</td>
</tr>
<tr>
<td style="text-align:left">
previous
</td>
<td>
985
</td>
<td>
2.684
</td>
<td>
0
</td>
<td>
1.922
</td>
<td>
16
</td>
</tr>
<tr>
<td style="text-align:left">
wl
</td>
<td>
985
</td>
<td>
0.697
</td>
<td>
0
</td>
<td>
0.540
</td>
<td>
2
</td>
</tr>
<tr>
<td style="text-align:left">
voteshare
</td>
<td>
985
</td>
<td>
19.205
</td>
<td>
1
</td>
<td>
30.354
</td>
<td>
74
</td>
</tr>
<tr>
<td style="text-align:left">
age
</td>
<td>
985
</td>
<td>
10.877
</td>
<td>
25
</td>
<td>
50.305
</td>
<td>
81
</td>
</tr>
<tr>
<td style="text-align:left">
nocand
</td>
<td>
985
</td>
<td>
0.737
</td>
<td>
2
</td>
<td>
3.432
</td>
<td>
6
</td>
</tr>
<tr>
<td style="text-align:left">
rank
</td>
<td>
985
</td>
<td>
1.033
</td>
<td>
1
</td>
<td>
2.214
</td>
<td>
6
</td>
</tr>
<tr>
<td style="text-align:left">
vote
</td>
<td>
985
</td>
<td>
45,693.650
</td>
<td>
1,557
</td>
<td>
68,872.310
</td>
<td>
197,037
</td>
</tr>
<tr>
<td style="text-align:left">
eligible
</td>
<td>
985
</td>
<td>
63,990.150
</td>
<td>
214,235
</td>
<td>
344,626.400
</td>
<td>
465,181
</td>
</tr>
<tr>
<td style="text-align:left">
turnout
</td>
<td>
985
</td>
<td>
3.896
</td>
<td>
57.400
</td>
<td>
67.663
</td>
<td>
79.600
</td>
</tr>
<tr>
<td style="text-align:left">
exp
</td>
<td>
985
</td>
<td>
5,569,641.000
</td>
<td>
62,710
</td>
<td>
8,142,244.000
</td>
<td>
24,649,710
</td>
</tr>
<tr>
<td style="text-align:left">
expm
</td>
<td>
985
</td>
<td>
5.570
</td>
<td>
0.063
</td>
<td>
8.142
</td>
<td>
24.650
</td>
</tr>
<tr>
<td style="text-align:left">
vs
</td>
<td>
985
</td>
<td>
0.192
</td>
<td>
0.006
</td>
<td>
0.304
</td>
<td>
0.736
</td>
</tr>
<tr>
<td style="text-align:left">
exppv
</td>
<td>
985
</td>
<td>
17.907
</td>
<td>
0.148
</td>
<td>
24.627
</td>
<td>
89.332
</td>
</tr>
<tr>
<td style="text-align:left">
smd
</td>
<td>
985
</td>
<td>
0.460
</td>
<td>
0
</td>
<td>
0.303
</td>
<td>
1
</td>
</tr>
<tr>
<td style="text-align:left">
ldp
</td>
<td>
985
</td>
<td>
0.456
</td>
<td>
0
</td>
<td>
0.293
</td>
<td>
1
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
<table>
<thead>
<tr class="header">
<th>変数名</th>
<th>内容 　</th>
<th>備考</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>year</td>
<td>実施年 　</td>
<td></td>
</tr>
<tr class="even">
<td>ku</td>
<td>都道府県</td>
<td></td>
</tr>
<tr class="odd">
<td>kun</td>
<td>区域 　</td>
<td></td>
</tr>
<tr class="even">
<td>status</td>
<td>現職か否か</td>
<td>0 = 新人・元, 1 = 現職</td>
</tr>
<tr class="odd">
<td>name</td>
<td>名前</td>
<td></td>
</tr>
<tr class="even">
<td>party</td>
<td>所属政党</td>
<td>ローマ字での略語</td>
</tr>
<tr class="odd">
<td>party_code</td>
<td>所属政党</td>
<td>数字で通し番号</td>
</tr>
<tr class="even">
<td>previous</td>
<td>当選回数</td>
<td></td>
</tr>
<tr class="odd">
<td>wl</td>
<td>当落結果　</td>
<td>0 = 落選, 1 = 当選, 2 = 復活当選</td>
</tr>
<tr class="even">
<td>voteshare</td>
<td>得票率</td>
<td>単位: %</td>
</tr>
<tr class="odd">
<td>age</td>
<td>年齢</td>
<td></td>
</tr>
<tr class="even">
<td>nocand</td>
<td>候補者数</td>
<td></td>
</tr>
<tr class="odd">
<td>rank</td>
<td>順位　　　</td>
<td></td>
</tr>
<tr class="even">
<td>vote</td>
<td>得票数　　</td>
<td></td>
</tr>
<tr class="odd">
<td>eligible</td>
<td>有権者数</td>
<td></td>
</tr>
<tr class="even">
<td>turnout</td>
<td>投票率</td>
<td>単位: %</td>
</tr>
<tr class="odd">
<td>exp</td>
<td>選挙費用</td>
<td>単位: 円</td>
</tr>
<tr class="even">
<td>expm</td>
<td>選挙費用　</td>
<td>単位: 百万円</td>
</tr>
<tr class="odd">
<td>vs</td>
<td>得票割合</td>
<td>小数で表記</td>
</tr>
<tr class="even">
<td>exppv</td>
<td>選挙費用</td>
<td>単位: 円（有権者一人当たりの選挙費用）</td>
</tr>
<tr class="odd">
<td>smd</td>
<td>当落</td>
<td>0 = 落選, 1 = 当選</td>
</tr>
<tr class="even">
<td>party_jpn</td>
<td>所属政党　</td>
<td>日本語</td>
</tr>
</tbody>
</table>
<div id="従属変数の設定" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> 従属変数の設定</h2>
<blockquote>
<p>従属変数: smd（当落）</p>
</blockquote>
<p>今回は明確に従属変数にする変数が決められる。 しかし、ビジネスの世界ではKPIの設定が難しい。 1つ言えることは、「良い結果を出すために恣意的に従属変数を選択することはやめよう」ということのみだ。</p>
</div>
<div id="独立変数の設定" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> 独立変数の設定</h2>
<blockquote>
<p>独立変数: exppv（選挙費用 単位: 百万）</p>
</blockquote>
<p>これも選挙費用で考える余地なし。</p>
</div>
</div>
<div id="ロジスティック回帰分析" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> ロジスティック回帰分析</h1>
<div id="ロジスティック回帰分析の実行" class="section level2" number="7.1">
<h2 number="7.1"><span class="header-section-number">7.1</span> ロジスティック回帰分析の実行</h2>
<p>これが本分析のモデルだ。</p>
<pre class="r"><code>model &lt;- glm(smd ~ expm + previous + ldp, data = data, family = binomial(link = &quot;logit&quot;))</code></pre>
<p>独立変数の推定値や統計的に有意であることが統制変数を組み込んでいくことでどのように変化するか確認するために、 以下のようなロジスティック回帰分析を一緒に表に併記する。</p>
<pre class="r"><code>lm1 &lt;- glm(smd ~ expm, data = data, family = binomial(link = &quot;logit&quot;))
lm2 &lt;- glm(smd ~ expm + previous, data = data, family = binomial(link = &quot;logit&quot;))</code></pre>
<p>統制変数を増やしていくと推定値が徐々に小さくなっていき、AICが小さくなっている。 当選回数と自民党ダミーが選挙費用と交絡関係になっていたことが理解できると思う。</p>
<pre class="r"><code>stargazer(lm1, lm2, model,
          type = &quot;html&quot;,
          style = &quot;ajps&quot;,
          digits = 2, 
          align = T, # 中央揃え
          dep.var.labels = &quot;当落&quot;,
          covariate.labels = c(&quot;選挙費用&quot;, 
                               &quot;当選回数&quot;, 
                               &quot;自民党ダミー&quot;))</code></pre>
<table style="text-align:center">
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
<strong>当落</strong>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<strong>Model 1</strong>
</td>
<td>
<strong>Model 2</strong>
</td>
<td>
<strong>Model 3</strong>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
選挙費用
</td>
<td>
0.26<sup>***</sup>
</td>
<td>
0.16<sup>***</sup>
</td>
<td>
0.08<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.02)
</td>
<td>
(0.02)
</td>
<td>
(0.02)
</td>
</tr>
<tr>
<td style="text-align:left">
当選回数
</td>
<td>
</td>
<td>
0.55<sup>***</sup>
</td>
<td>
0.57<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
(0.05)
</td>
<td>
(0.06)
</td>
</tr>
<tr>
<td style="text-align:left">
自民党ダミー
</td>
<td>
</td>
<td>
</td>
<td>
2.60<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
(0.23)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-3.21<sup>***</sup>
</td>
<td>
-3.60<sup>***</sup>
</td>
<td>
-3.94<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.20)
</td>
<td>
(0.23)
</td>
<td>
(0.28)
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
985
</td>
<td>
985
</td>
<td>
985
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-452.47
</td>
<td>
-360.70
</td>
<td>
-286.11
</td>
</tr>
<tr>
<td style="text-align:left">
AIC
</td>
<td>
908.94
</td>
<td>
727.40
</td>
<td>
580.22
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="4" style="text-align:left">
<sup><em><strong></sup>p &lt; .01; <sup></strong></sup>p &lt; .05; <sup></em></sup>p &lt; .1
</td>
</tr>
</table>
<p>他の要因を平均値に固定し、変数を1単位増やした場合に得られるOdsは以下の通りだ</p>
<pre class="r"><code>exp(model$coefficients)</code></pre>
<pre><code>(Intercept)        expm    previous         ldp 
 0.01937353  1.08697524  1.76636625 13.45087534 </code></pre>
<p>他の要因を平均値に固定し、変数を1単位増やした場合に得られる当選確率は以下の通りだ</p>
<pre class="r"><code>1 / (1 + exp(-model$coefficients))</code></pre>
<pre><code>(Intercept)        expm    previous         ldp 
 0.01900533  0.52083763  0.63851496  0.93080004 </code></pre>
</div>
<div id="モデルの診断" class="section level2" number="7.2">
<h2 number="7.2"><span class="header-section-number">7.2</span> モデルの診断</h2>
<div id="roc曲線" class="section level3" number="7.2.1">
<h3 number="7.2.1"><span class="header-section-number">7.2.1</span> ROC曲線</h3>
<p>左上にROC曲線が近づけば近づくほど良いモデルと考えられる。 最近、このような疫学的なアプローチの重要性がよくわかるよね…（例の感染症のせいで） 計量政治学の世界では最近ようやく一般化されてきたように感じる。（私が古い人間の可能性は否定できない）</p>
<pre class="r"><code>roc &lt;- model %&gt;% 
  predict(type = &quot;response&quot;) %&gt;% 
  ROCR::prediction(labels = data$smd == 1) %&gt;% 
  performance(&quot;tpr&quot;, &quot;fpr&quot;) 

df_roc &lt;- data.frame(tpr = roc@y.values[[1]], fpr = roc@x.values[[1]])

ggplot(df_roc, aes(x = fpr, y = tpr)) + 
  geom_line(color = &quot;red&quot;) +
  geom_abline(intercept = 0, slope = 1, linetype = &quot;dashed&quot;) +
  coord_fixed() +
  labs(x = &quot;偽陽性率(1 - 特異度)&quot;, y = &quot;真陽性率(感度)&quot;)</code></pre>
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="auc" class="section level3" number="7.2.2">
<h3 number="7.2.2"><span class="header-section-number">7.2.2</span> AUC</h3>
<p>AUCの値が0.9430654で、非常にモデルの当てはまりが良いことが分かる。</p>
<pre class="r"><code># AUC

auc &lt;- model %&gt;% 
  predict(type = &quot;response&quot;) %&gt;% 
  ROCR::prediction(labels = data$smd == 1) %&gt;% 
  performance(&quot;auc&quot;)

auc@y.values[[1]]  </code></pre>
<pre><code>[1] 0.9430654</code></pre>
</div>
</div>
<div id="点区間推定の可視化" class="section level2" number="7.3">
<h2 number="7.3"><span class="header-section-number">7.3</span> 点・区間推定の可視化</h2>
<p>どれも統計的に有意であることがわかる。 ただ、選挙費用が当選確率に与える「影響の大きさ」を読み取ることは不可能。 選挙費用が当選確率に与える「影響の大きさ」を確認するには、限界効果を確認する必要がある。</p>
<pre class="r"><code>model %&gt;% 
  tidy() %&gt;% 
  mutate(ll = estimate + qnorm(0.025) * std.error, 
         ul = estimate + qnorm(0.975) * std.error,
         fit = 1 / (1 + exp(-estimate)), 
         lower = 1 / (1 + exp(-ll)), 
         upper = 1 / (1 + exp(-ul))) %&gt;% 
  filter(!term == &quot;(Intercept)&quot;) %&gt;% 
  transform(term = factor(term, levels = c(&quot;ldp&quot; ,&quot;previous&quot;, &quot;expm&quot;))) %&gt;%
  ggplot(aes(x = term,
             y = fit)) +
  geom_pointrange(aes(ymin = lower,
                      ymax = upper),
                  color = &quot;blue&quot;,
                  size = 1) +
  geom_hline(yintercept = 0, 
             linetype = 2, 
             color = &quot;red&quot;) +
  geom_text(aes(x = term,
                y = fit,
                label = round(fit, 2)),
            vjust = -1) +
  scale_x_discrete(labels = c(&quot;expm&quot; = &quot;選挙費用&quot;,
                              &quot;previous&quot; = &quot;当選回数&quot;,
                              &quot;ldp&quot; = &quot;政党規模&quot;)) +
  scale_y_continuous(breaks = seq(0, 1, length = 11)) +
  labs(x = NULL, y = &quot;推定値&quot;) +
  coord_flip()</code></pre>
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="予測確率限界効果の可視化" class="section level2" number="7.4">
<h2 number="7.4"><span class="header-section-number">7.4</span> 予測確率・限界効果の可視化</h2>
<div id="予測確率" class="section level3" number="7.4.1">
<h3 number="7.4.1"><span class="header-section-number">7.4.1</span> 予測確率</h3>
<p>統制変数を平均値に固定し、独立変数である選挙費用が増えるとどのような予測確率を得られるのかを可視化した。</p>
<pre class="r"><code>cplot(model, 
      x = &quot;expm&quot;, 
      what = &quot;prediction&quot;,
      data = data,
      draw = F) %&gt;%
  as_data_frame() %&gt;%
  ggplot(aes(x = xvals, y = yvals, ymin = lower, ymax = upper)) +
  geom_ribbon(color = &quot;lightblue&quot;,
              fill = &quot;skyblue&quot;,
              alpha = .3) +
  geom_line(color = &quot;blue&quot;) +
  geom_pointrange() +
  labs(x = &quot;選挙費用（単位：100万円）&quot;, 
       y = &quot;予測当選確率の予測値&quot;) </code></pre>
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="限界効果" class="section level3" number="7.4.2">
<h3 number="7.4.2"><span class="header-section-number">7.4.2</span> 限界効果</h3>
<p>選挙費用が得票率に与えている影響を可視化したものだ。 1000万円かけても当選確率に与える影響は 0.01 = 1% 以下であることを考えると、非常にコスパが悪い</p>
<pre class="r"><code>cplot(model, 
      x = &quot;expm&quot;, 
      what = &quot;effect&quot;,
      data = data,
      draw = F) %&gt;%
  as_data_frame() %&gt;%
  ggplot(aes(x = xvals, y = yvals, ymin = lower, ymax = upper)) +
  geom_ribbon(color = &quot;lightblue&quot;,
              fill = &quot;skyblue&quot;,
              alpha = .3) +
  geom_line(color = &quot;blue&quot;) +
  geom_pointrange() +
  geom_hline(yintercept = 0,
             linetype = 2,
             color = &quot;red&quot;) +
  labs(x = &quot;選挙費用（単位：100万円）&quot;, 
       y = &quot;選挙費用の平均限界効果（AME）&quot;)</code></pre>
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="分析結果の解釈" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> 分析結果の解釈</h1>
<p>分析が終わったとしても、気を抜いてはいけない。 アカデミックな世界ならば論文に、ビジネスの世界なら報告書に、この分析結果をまとめ上げなくてはならない。 分析結果をまとめるには、重回帰分析の表だけではなく、キャタピラープロットやベータ値を出しておく必要がある。 今回の分析をまとめると、こうなる。</p>
<p>本分析は、「選挙費用が当選確率に与える影響はどれほどか」という問いに対し、ロジスティック回帰分析を用いて解明を試みた。 その結果、選挙費用と選挙の当落には統計的に有意な関係にあるとわかった。また、AUCの値が約0.94と、モデルに組み込んでいない変数の影響を無視できるであろうことから、確度の高い結果であると言える。 統制変数を平均値で固定し、選挙費用だけを変化させた場合の予測確率の図から、選挙費用を削ることは得策ではないとわかる。 平均限界効果は選挙費用が高くなるにつれて上昇し、0のラインに95%信頼区間がかかることがない。 このことからも、選挙費用が確かに当落に関係していることが分かる。ただ、影響は小さく、実質的な有意性はないと考えられる。非常にコスパが悪い。 ただ、所属政党や当選回数は自らの意思で決めることはできないため、選挙に勝つためには自ら設定できる選挙費用は非常に重要な要因であろう。コスパは悪いが、コストをかけざるをえないだろう。</p>
<p>以上のようになる。 論文であればもう少し論文の目的を振り返っても良いだろう。</p>
<p>enjoy !</p>
<HR>
<p>この記事のコードをまとめたものは<a href="https://github.com/FruitGranola/R_Logistic_Regression">Github</a>にあります。</p>
<button>
<a href="index.html">Homeに戻る</a>
</button>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIkxvZ2lzdGljX1JlZ3Jlc3Npb24iDQpkYXRlOiAiYHIgU3lzLnRpbWUoKWAiDQotLS0NCg0KYGBgez1odG1sfQ0KPHN0eWxlPg0KICANCiAgdGFibGUsIHRkLCB0aCB7DQogICAgYm9yZGVyOiBub25lOw0KICAgIHBhZGRpbmctbGVmdDogMWVtOw0KICAgIHBhZGRpbmctcmlnaHQ6IDFlbTsNCiAgICBtaW4td2lkdGg6IDc1JTsNCiAgICBtYXJnaW4tbGVmdDogYXV0bzsNCiAgICBtYXJnaW4tcmlnaHQ6IGF1dG87DQogICAgbWFyZ2luLXRvcDogMWVtOw0KICAgIG1hcmdpbi1ib3R0b206IDFlbTsNCiAgfQ0KDQo8L3N0eWxlPg0KYGBgDQoNCmBgYHtyLCBpbmNsdWRlPUZBTFNFfQ0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KHdhcm5pbmcgPSBGLA0KICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBGLA0KICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQgPSAiIiwNCiAgICAgICAgICAgICAgICAgICAgICBmaWcuYWxpZ24gPSAiY2VudGVyIikNCmBgYA0KDQoNCiMg5L2/55So44GZ44KL44OR44OD44Kx44O844K4DQoNCmBgYHtyfQ0KbGlicmFyeSh0aWR5dmVyc2UpDQpsaWJyYXJ5KG1hZ3JpdHRyKQ0KbGlicmFyeShzdGFyZ2F6ZXIpDQpsaWJyYXJ5KFJPQ1IpDQpsaWJyYXJ5KGJyb29tKQ0KbGlicmFyeShtYXJnaW5zKQ0KDQp0aGVtZV9zZXQodGhlbWVfbWluaW1hbChiYXNlX2ZhbWlseSA9IDE1KSkNCmBgYA0KDQojIOS9v+eUqOOBmeOCi+ODh+ODvOOCvw0KDQrjg4fjg7zjgr/jga9b44GT44Gh44KJXSguL2RhdGEvSG91c2Vfb2ZfQ291bmNpbG9yc18xOTk2XzIwMTcuY3N2KQ0KDQpgYGB7cn0NCmRhdGEgPC0gcmVhZF9jc3YoIkRhdGEvSG91c2Vfb2ZfQ291bmNpbG9yc18xOTk2XzIwMTcuY3N2IikNCmBgYA0KDQpgYGB7cn0NCmRhdGEgJTw+JSANCiAgZmlsdGVyKHllYXIgPT0gMjAwNSkgJT4lIA0KICBtdXRhdGUoImxkcCIgPSBpZl9lbHNlKHBhcnR5X2pwbiAlaW4lICBjKCLoh6rmsJHlhZoiKSwgMSwgMCkpICU+JSANCiAgZHJvcF9uYSgpICU+JSANCiAgYXMuZGF0YS5mcmFtZSgpDQpgYGANCg0KIyDliIbmnpDjgpLjgZnjgovmtYHjgowNCg0KMS4g5YiG5p6Q44Gu55uu55qE44KS6Kit5a6a44GZ44KLICANCjIuIOeQhuirluOBqOS7ruiqrCAgDQozLiDlpInmlbDpgbjmip4gIA0KMy0xLuW+k+WxnuWkieaVsOOCkuioreWumiAgDQozLTIuIOeLrOeri+WkieaVsOOBruioreWumiAgDQo0LiDjg63jgrjjgrnjg4bjgqPjg4Pjgq/luLDliIbmnpAgIA0KNC0xLiDjg63jgrjjgrnjg4bjgqPjg4Pjgq/lm57luLDliIbmnpDjga7lrp/ooYwgIA0KNC0yLiDjg6Ljg4fjg6vjga7oqLrmlq0gIA0KNC0zLiDngrnjg7vljLrplpPmjqjlrprjga7lj6/oppbljJYgIA0KNC00LiDkuojmuKznorrnjofjg7vpmZDnlYzlirnmnpzjga7lj6/oppbljJYgIA0KNS4g5YiG5p6Q57WQ5p6c44Gu6Kej6YeIDQoNCiMg5YiG5p6Q44Gu55uu55qE44KS6Kit5a6a44GZ44KLDQoNCuODreOCuOOCueODhuOCo+ODg+OCr+WbnuW4sOWIhuaekOOCkuS9v+OBo+OBpuWIhuaekOOCkuOBmeOCi+WgtOWQiOOBrzLlgKTlpInmlbDjgYzlvpPlsZ7lpInmlbDjgavjgarjgovnj77osaHjgpLmjqLjgZnlv4XopoHjgYzjgYLjgovjgIINCuioiOmHj+aUv+ayu+WtpuOBruS4lueVjOOBp+OBr+mBuOaMmeOBruW9k+mBuOODu+iQvemBuOOCkjDjgIEx44Gn6KGo54++44GX44CB44Ot44K444K544OG44Kj44OD44Kv5Zue5biw5YiG5p6Q44KS6KGM44GG44GT44Go44GM44KI44GP44GC44KL44CCDQoNCuS7iuWbnuOBr+mBuOaMmeeglOeptuOCkuS6i+S+i+OBq+ODreOCuOOCueODhuOCo+ODg+OCr+WbnuW4sOWIhuaekOOBrua1geOCjOOCkue0ueS7i+OBmeOCi+OAgg0K44Gd44Gu44GG44GI44Gn44CB44CM6YG45oyZ44Gu5b2T6JC957WQ5p6c44Gr6YG45oyZ6LK755So44GM5LiO44GI44KL5b2x6Z+/44CN44KS5o6o5a6a44GZ44KL44GT44Go44KS55uu55qE44Go44GZ44KL44CCDQoNCiMg55CG6KuW44Go5Luu6KqsDQoNCuWkieaVsOmBuOaKnuOCkuOBmeOCi+mam+OBr+OAgeODquOCteODvOODgeOCr+OCqOOCueODgeODp+ODs+OBi+OCieOBqeOBruOCiOOBhuOBqueQhuirluOCkueri+OBpuOCieOCjOOCi+OBruOBi+OAgg0K44Gd44GX44Gm44CB44GT44Gu55CG6KuW44KS5a6f6Ki844GZ44KL44Gr44Gv44CB44Gp44Gu44KI44GG44Gq5Luu6Kqs44KS56uL44Gm44Gm5qSc6Ki844GZ44KL44G544GN44GL44KS6ICD44GI44KL5b+F6KaB44GM44GC44KL44CCDQrjgZ3jga7jgZ/jgoHjgIHnkIboq5bjgajku67oqqzjga7oqK3lrprjgYzjgajjgabjgoLph43opoHjgaDjgIINCg0KPueQhuirljogIA0KIOmBuOaMmeOBq+mHkeOCkuOBi+OBkeOCi+OBqOOAjOOCueOCv+ODg+ODleOBruWil+WToeOAjeODu+OAjOmBuOaMmeOCq+ODvOOBruS9v+eUqOOAjeOBquOBqeOBjOWPr+iDveOBq+OBquOCiuOAgeW9k+mBuOeiuueOh+OBjOmrmOOBj+OBquOCiw0KDQrkuIroqJjjga7nkIboq5bjgYzmraPjgZfjgZHjgozjgbDjgIHku6XkuIvjga7jgojjgYbjgarku67oqqzjgYznq4vjgabjgonjgozjgovjgIINCg0KPuS7ruiqrDogIA0KIOmBuOaMmeiyu+eUqOOBjOWkmuOBkeOCjOOBsOWkmuOBhOOBu+OBqeOAgeW9k+mBuOeiuueOh+OBjOmrmOOBhA0KDQojIOWkieaVsOmBuOaKng0KDQpgYGB7ciwgcmVzdWx0cz0nYXNpcyd9DQojIOimgee0hOe1seioiOmHj+OCkkhUTUzjgaflh7rlipvjgZnjgovjgIINCiMg44OB44Oj44Oz44Kv44Kq44OX44K344On44Oz44GrcmVzdWx0cz0nYXNpcyfjgpLlv5jjgozjgarjgYTjgojjgYbjgasNCg0KZGF0YSAlPiUgDQogIHN0YXJnYXplcih0eXBlID0gImh0bWwiLA0KICAgICAgICAgICAgc3VtbWFyeS5zdGF0ID0gYygibiIsICJzZCIsICJtaW4iLCAibWVhbiIsICJtYXgiKSwgDQogICAgICAgICAgICB0aXRsZSA9ICLopoHntITntbHoqIjph48iLA0KICAgICAgICAgICAgYWxpZ24gPSBUKQ0KYGBgDQoNCnzlpInmlbDlkI0gICAgfOWGheWuuSAgICDjgIB85YKZ6ICDICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnwtLS0tLS0tLS0tfC0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18DQp8eWVhciAgICAgIHzlrp/mlr3lubQgIOOAgHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnxrdSAgICAgICAgfOmDvemBk+W6nOecjCAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KfGt1biAgICAgICB85Yy65Z+fICAgIOOAgHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnxzdGF0dXMgICAgfOePvuiBt+OBi+WQpuOBi3wwID0g5paw5Lq644O75YWDLCAxID0g54++6IG3ICAgICAgICAgICAgICAgIHwNCnxuYW1lICAgICAgfOWQjeWJjSAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnxwYXJ0eSAgICAgfOaJgOWxnuaUv+WFmiAgfOODreODvOODnuWtl+OBp+OBrueVpeiqniAgICAgICAgICAgICAgICAgICAgICB8DQp8cGFydHlfY29kZXzmiYDlsZ7mlL/lhZogIHzmlbDlrZfjgafpgJrjgZfnlarlj7cgICAgICAgICAgICAgICAgICAgICAgICB8DQp8cHJldmlvdXMgIHzlvZPpgbjlm57mlbAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnx3bCAgICAgICAgfOW9k+iQvee1kOaenOOAgHwwID0g6JC96YG4LCAxID0g5b2T6YG4LCAyID0g5b6p5rS75b2T6YG4ICAgICAgfA0KfHZvdGVzaGFyZSB85b6X56Wo546HICAgIHzljZjkvY06ICUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KfGFnZSAgICAgICB85bm06b2iICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KfG5vY2FuZCAgICB85YCZ6KOc6ICF5pWwICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQp8cmFuayAgICAgIHzpoIbkvY3jgIDjgIDjgIB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQp8dm90ZSAgICAgIHzlvpfnpajmlbDjgIDjgIB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQp8ZWxpZ2libGUgIHzmnInmqKnogIXmlbAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnx0dXJub3V0CSB85oqV56Wo546HICAgIHzljZjkvY06ICUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KfGV4cAkgICAgIHzpgbjmjJnosrvnlKggIHzljZjkvY06IOWGhiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnxleHBtICAgICAgfOmBuOaMmeiyu+eUqOOAgHzljZjkvY06IOeZvuS4h+WGhiAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KfHZzCSAgICAgICB85b6X56Wo5Ymy5ZCIICB85bCP5pWw44Gn6KGo6KiYICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCnxleHBwdiAgICAgfOmBuOaMmeiyu+eUqCAgfOWNmOS9jTog5YaG77yI5pyJ5qip6ICF5LiA5Lq65b2T44Gf44KK44Gu6YG45oyZ6LK755So77yJfA0KfHNtZAkgICAgIHzlvZPokL0gICAgICB8MCA9IOiQvemBuCwgMSA9IOW9k+mBuCAgICAgICAgICAgICAgICAgICAgfA0KfHBhcnR5X2pwbiB85omA5bGe5pS/5YWa44CAfOaXpeacrOiqniAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfA0KDQojIyDlvpPlsZ7lpInmlbDjga7oqK3lrpoNCg0KPuW+k+WxnuWkieaVsDogc21k77yI5b2T6JC977yJDQoNCuS7iuWbnuOBr+aYjueiuuOBq+W+k+WxnuWkieaVsOOBq+OBmeOCi+WkieaVsOOBjOaxuuOCgeOCieOCjOOCi+OAgg0K44GX44GL44GX44CB44OT44K444ON44K544Gu5LiW55WM44Gn44GvS1BJ44Gu6Kit5a6a44GM6Zuj44GX44GE44CCDQox44Gk6KiA44GI44KL44GT44Go44Gv44CB44CM6Imv44GE57WQ5p6c44KS5Ye644GZ44Gf44KB44Gr5oGj5oSP55qE44Gr5b6T5bGe5aSJ5pWw44KS6YG45oqe44GZ44KL44GT44Go44Gv44KE44KB44KI44GG44CN44Go44GE44GG44GT44Go44Gu44G/44Gg44CCDQoNCiMjIOeLrOeri+WkieaVsOOBruioreWumg0KDQo+54us56uL5aSJ5pWwOiBleHBwdu+8iOmBuOaMmeiyu+eUqCDljZjkvY06IOeZvuS4h++8iQ0KDQrjgZPjgozjgoLpgbjmjJnosrvnlKjjgafogIPjgYjjgovkvZnlnLDjgarjgZfjgIINCg0KIyDjg63jgrjjgrnjg4bjgqPjg4Pjgq/lm57luLDliIbmnpANCg0KIyMg44Ot44K444K544OG44Kj44OD44Kv5Zue5biw5YiG5p6Q44Gu5a6f6KGMDQoNCuOBk+OCjOOBjOacrOWIhuaekOOBruODouODh+ODq+OBoOOAgg0KDQpgYGB7cn0NCm1vZGVsIDwtIGdsbShzbWQgfiBleHBtICsgcHJldmlvdXMgKyBsZHAsIGRhdGEgPSBkYXRhLCBmYW1pbHkgPSBiaW5vbWlhbChsaW5rID0gImxvZ2l0IikpDQpgYGANCg0K54us56uL5aSJ5pWw44Gu5o6o5a6a5YCk44KE57Wx6KiI55qE44Gr5pyJ5oSP44Gn44GC44KL44GT44Go44GM57Wx5Yi25aSJ5pWw44KS57WE44G/6L6844KT44Gn44GE44GP44GT44Go44Gn44Gp44Gu44KI44GG44Gr5aSJ5YyW44GZ44KL44GL56K66KqN44GZ44KL44Gf44KB44Gr44CBDQrku6XkuIvjga7jgojjgYbjgarjg63jgrjjgrnjg4bjgqPjg4Pjgq/lm57luLDliIbmnpDjgpLkuIDnt5LjgavooajjgavkvbXoqJjjgZnjgovjgIINCg0KYGBge3J9DQpsbTEgPC0gZ2xtKHNtZCB+IGV4cG0sIGRhdGEgPSBkYXRhLCBmYW1pbHkgPSBiaW5vbWlhbChsaW5rID0gImxvZ2l0IikpDQpsbTIgPC0gZ2xtKHNtZCB+IGV4cG0gKyBwcmV2aW91cywgZGF0YSA9IGRhdGEsIGZhbWlseSA9IGJpbm9taWFsKGxpbmsgPSAibG9naXQiKSkNCmBgYA0KDQrntbHliLblpInmlbDjgpLlopfjgoTjgZfjgabjgYTjgY/jgajmjqjlrprlgKTjgYzlvpDjgIXjgavlsI/jgZXjgY/jgarjgaPjgabjgYTjgY3jgIFBSUPjgYzlsI/jgZXjgY/jgarjgaPjgabjgYTjgovjgIINCuW9k+mBuOWbnuaVsOOBqOiHquawkeWFmuODgOODn+ODvOOBjOmBuOaMmeiyu+eUqOOBqOS6pOe1oemWouS/guOBq+OBquOBo+OBpuOBhOOBn+OBk+OBqOOBjOeQhuino+OBp+OBjeOCi+OBqOaAneOBhuOAgg0KDQpgYGB7ciwgcmVzdWx0cz0nYXNpcyd9DQpzdGFyZ2F6ZXIobG0xLCBsbTIsIG1vZGVsLA0KICAgICAgICAgIHR5cGUgPSAiaHRtbCIsDQogICAgICAgICAgc3R5bGUgPSAiYWpwcyIsDQogICAgICAgICAgZGlnaXRzID0gMiwgDQogICAgICAgICAgYWxpZ24gPSBULCAjIOS4reWkruaPg+OBiA0KICAgICAgICAgIGRlcC52YXIubGFiZWxzID0gIuW9k+iQvSIsDQogICAgICAgICAgY292YXJpYXRlLmxhYmVscyA9IGMoIumBuOaMmeiyu+eUqCIsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICLlvZPpgbjlm57mlbAiLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAi6Ieq5rCR5YWa44OA44Of44O8IikpDQpgYGANCg0K5LuW44Gu6KaB5Zug44KS5bmz5Z2H5YCk44Gr5Zu65a6a44GX44CB5aSJ5pWw44KSMeWNmOS9jeWil+OChOOBl+OBn+WgtOWQiOOBq+W+l+OCieOCjOOCi09kc+OBr+S7peS4i+OBrumAmuOCiuOBoA0KDQpgYGB7cn0NCmV4cChtb2RlbCRjb2VmZmljaWVudHMpDQpgYGANCg0K5LuW44Gu6KaB5Zug44KS5bmz5Z2H5YCk44Gr5Zu65a6a44GX44CB5aSJ5pWw44KSMeWNmOS9jeWil+OChOOBl+OBn+WgtOWQiOOBq+W+l+OCieOCjOOCi+W9k+mBuOeiuueOh+OBr+S7peS4i+OBrumAmuOCiuOBoA0KDQpgYGB7cn0NCjEgLyAoMSArIGV4cCgtbW9kZWwkY29lZmZpY2llbnRzKSkNCmBgYA0KDQojIyDjg6Ljg4fjg6vjga7oqLrmlq0NCg0KIyMjIFJPQ+absue3mg0KDQrlt6bkuIrjgatST0Pmm7Lnt5rjgYzov5HjgaXjgZHjgbDov5HjgaXjgY/jgbvjganoia/jgYTjg6Ljg4fjg6vjgajogIPjgYjjgonjgozjgovjgIINCuacgOi/keOAgeOBk+OBruOCiOOBhuOBqueWq+WtpueahOOBquOCouODl+ODreODvOODgeOBrumHjeimgeaAp+OBjOOCiOOBj+OCj+OBi+OCi+OCiOOBrS4uLu+8iOS+i+OBruaEn+afk+eXh+OBruOBm+OBhOOBp++8iQ0K6KiI6YeP5pS/5rK75a2m44Gu5LiW55WM44Gn44Gv5pyA6L+R44KI44GG44KE44GP5LiA6Iis5YyW44GV44KM44Gm44GN44Gf44KI44GG44Gr5oSf44GY44KL44CC77yI56eB44GM5Y+k44GE5Lq66ZaT44Gu5Y+v6IO95oCn44Gv5ZCm5a6a44Gn44GN44Gq44GE77yJDQoNCmBgYHtyfQ0Kcm9jIDwtIG1vZGVsICU+JSANCiAgcHJlZGljdCh0eXBlID0gInJlc3BvbnNlIikgJT4lIA0KICBST0NSOjpwcmVkaWN0aW9uKGxhYmVscyA9IGRhdGEkc21kID09IDEpICU+JSANCiAgcGVyZm9ybWFuY2UoInRwciIsICJmcHIiKSANCg0KZGZfcm9jIDwtIGRhdGEuZnJhbWUodHByID0gcm9jQHkudmFsdWVzW1sxXV0sIGZwciA9IHJvY0B4LnZhbHVlc1tbMV1dKQ0KDQpnZ3Bsb3QoZGZfcm9jLCBhZXMoeCA9IGZwciwgeSA9IHRwcikpICsgDQogIGdlb21fbGluZShjb2xvciA9ICJyZWQiKSArDQogIGdlb21fYWJsaW5lKGludGVyY2VwdCA9IDAsIHNsb3BlID0gMSwgbGluZXR5cGUgPSAiZGFzaGVkIikgKw0KICBjb29yZF9maXhlZCgpICsNCiAgbGFicyh4ID0gIuWBvemZveaAp+eOhygxIC0g54m555Ww5bqmKSIsIHkgPSAi55yf6Zm95oCn546HKOaEn+W6pikiKQ0KYGBgDQoNCiMjIyBBVUMNCg0KQVVD44Gu5YCk44GMMC45NDMwNjU044Gn44CB6Z2e5bi444Gr44Oi44OH44Or44Gu5b2T44Gm44Gv44G+44KK44GM6Imv44GE44GT44Go44GM5YiG44GL44KL44CCDQoNCmBgYHtyfQ0KIyBBVUMNCg0KYXVjIDwtIG1vZGVsICU+JSANCiAgcHJlZGljdCh0eXBlID0gInJlc3BvbnNlIikgJT4lIA0KICBST0NSOjpwcmVkaWN0aW9uKGxhYmVscyA9IGRhdGEkc21kID09IDEpICU+JSANCiAgcGVyZm9ybWFuY2UoImF1YyIpDQoNCmF1Y0B5LnZhbHVlc1tbMV1dICANCmBgYA0KDQojIyDngrnjg7vljLrplpPmjqjlrprjga7lj6/oppbljJYNCg0K44Gp44KM44KC57Wx6KiI55qE44Gr5pyJ5oSP44Gn44GC44KL44GT44Go44GM44KP44GL44KL44CCDQrjgZ/jgaDjgIHpgbjmjJnosrvnlKjjgYzlvZPpgbjnorrnjofjgavkuI7jgYjjgovjgIzlvbHpn7/jga7lpKfjgY3jgZXjgI3jgpLoqq3jgb/lj5bjgovjgZPjgajjga/kuI3lj6/og73jgIINCumBuOaMmeiyu+eUqOOBjOW9k+mBuOeiuueOh+OBq+S4juOBiOOCi+OAjOW9semfv+OBruWkp+OBjeOBleOAjeOCkueiuuiqjeOBmeOCi+OBq+OBr+OAgemZkOeVjOWKueaenOOCkueiuuiqjeOBmeOCi+W/heimgeOBjOOBguOCi+OAgg0KDQpgYGB7cn0NCm1vZGVsICU+JSANCiAgdGlkeSgpICU+JSANCiAgbXV0YXRlKGxsID0gZXN0aW1hdGUgKyBxbm9ybSgwLjAyNSkgKiBzdGQuZXJyb3IsIA0KICAgICAgICAgdWwgPSBlc3RpbWF0ZSArIHFub3JtKDAuOTc1KSAqIHN0ZC5lcnJvciwNCiAgICAgICAgIGZpdCA9IDEgLyAoMSArIGV4cCgtZXN0aW1hdGUpKSwgDQogICAgICAgICBsb3dlciA9IDEgLyAoMSArIGV4cCgtbGwpKSwgDQogICAgICAgICB1cHBlciA9IDEgLyAoMSArIGV4cCgtdWwpKSkgJT4lIA0KICBmaWx0ZXIoIXRlcm0gPT0gIihJbnRlcmNlcHQpIikgJT4lIA0KICB0cmFuc2Zvcm0odGVybSA9IGZhY3Rvcih0ZXJtLCBsZXZlbHMgPSBjKCJsZHAiICwicHJldmlvdXMiLCAiZXhwbSIpKSkgJT4lDQogIGdncGxvdChhZXMoeCA9IHRlcm0sDQogICAgICAgICAgICAgeSA9IGZpdCkpICsNCiAgZ2VvbV9wb2ludHJhbmdlKGFlcyh5bWluID0gbG93ZXIsDQogICAgICAgICAgICAgICAgICAgICAgeW1heCA9IHVwcGVyKSwNCiAgICAgICAgICAgICAgICAgIGNvbG9yID0gImJsdWUiLA0KICAgICAgICAgICAgICAgICAgc2l6ZSA9IDEpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwgDQogICAgICAgICAgICAgbGluZXR5cGUgPSAyLCANCiAgICAgICAgICAgICBjb2xvciA9ICJyZWQiKSArDQogIGdlb21fdGV4dChhZXMoeCA9IHRlcm0sDQogICAgICAgICAgICAgICAgeSA9IGZpdCwNCiAgICAgICAgICAgICAgICBsYWJlbCA9IHJvdW5kKGZpdCwgMikpLA0KICAgICAgICAgICAgdmp1c3QgPSAtMSkgKw0KICBzY2FsZV94X2Rpc2NyZXRlKGxhYmVscyA9IGMoImV4cG0iID0gIumBuOaMmeiyu+eUqCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicHJldmlvdXMiID0gIuW9k+mBuOWbnuaVsCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAibGRwIiA9ICLmlL/lhZropo/mqKEiKSkgKw0KICBzY2FsZV95X2NvbnRpbnVvdXMoYnJlYWtzID0gc2VxKDAsIDEsIGxlbmd0aCA9IDExKSkgKw0KICBsYWJzKHggPSBOVUxMLCB5ID0gIuaOqOWumuWApCIpICsNCiAgY29vcmRfZmxpcCgpDQpgYGANCg0KIyMg5LqI5ris56K6546H44O76ZmQ55WM5Yq55p6c44Gu5Y+v6KaW5YyWDQoNCiMjIyDkuojmuKznorrnjocNCg0K57Wx5Yi25aSJ5pWw44KS5bmz5Z2H5YCk44Gr5Zu65a6a44GX44CB54us56uL5aSJ5pWw44Gn44GC44KL6YG45oyZ6LK755So44GM5aKX44GI44KL44Go44Gp44Gu44KI44GG44Gq5LqI5ris56K6546H44KS5b6X44KJ44KM44KL44Gu44GL44KS5Y+v6KaW5YyW44GX44Gf44CCDQoNCmBgYHtyfQ0KY3Bsb3QobW9kZWwsIA0KICAgICAgeCA9ICJleHBtIiwgDQogICAgICB3aGF0ID0gInByZWRpY3Rpb24iLA0KICAgICAgZGF0YSA9IGRhdGEsDQogICAgICBkcmF3ID0gRikgJT4lDQogIGFzX2RhdGFfZnJhbWUoKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0geHZhbHMsIHkgPSB5dmFscywgeW1pbiA9IGxvd2VyLCB5bWF4ID0gdXBwZXIpKSArDQogIGdlb21fcmliYm9uKGNvbG9yID0gImxpZ2h0Ymx1ZSIsDQogICAgICAgICAgICAgIGZpbGwgPSAic2t5Ymx1ZSIsDQogICAgICAgICAgICAgIGFscGhhID0gLjMpICsNCiAgZ2VvbV9saW5lKGNvbG9yID0gImJsdWUiKSArDQogIGdlb21fcG9pbnRyYW5nZSgpICsNCiAgbGFicyh4ID0gIumBuOaMmeiyu+eUqO+8iOWNmOS9je+8mjEwMOS4h+WGhu+8iSIsIA0KICAgICAgIHkgPSAi5LqI5ris5b2T6YG456K6546H44Gu5LqI5ris5YCkIikgDQpgYGANCg0KIyMjIOmZkOeVjOWKueaenA0KDQrpgbjmjJnosrvnlKjjgYzlvpfnpajnjofjgavkuI7jgYjjgabjgYTjgovlvbHpn7/jgpLlj6/oppbljJbjgZfjgZ/jgoLjga7jgaDjgIINCjEwMDDkuIflhobjgYvjgZHjgabjgoLlvZPpgbjnorrnjofjgavkuI7jgYjjgovlvbHpn7/jga8gMC4wMSA9IDElIOS7peS4i+OBp+OBguOCi+OBk+OBqOOCkuiAg+OBiOOCi+OBqOOAgemdnuW4uOOBq+OCs+OCueODkeOBjOaCquOBhA0KDQpgYGB7cn0NCmNwbG90KG1vZGVsLCANCiAgICAgIHggPSAiZXhwbSIsIA0KICAgICAgd2hhdCA9ICJlZmZlY3QiLA0KICAgICAgZGF0YSA9IGRhdGEsDQogICAgICBkcmF3ID0gRikgJT4lDQogIGFzX2RhdGFfZnJhbWUoKSAlPiUNCiAgZ2dwbG90KGFlcyh4ID0geHZhbHMsIHkgPSB5dmFscywgeW1pbiA9IGxvd2VyLCB5bWF4ID0gdXBwZXIpKSArDQogIGdlb21fcmliYm9uKGNvbG9yID0gImxpZ2h0Ymx1ZSIsDQogICAgICAgICAgICAgIGZpbGwgPSAic2t5Ymx1ZSIsDQogICAgICAgICAgICAgIGFscGhhID0gLjMpICsNCiAgZ2VvbV9saW5lKGNvbG9yID0gImJsdWUiKSArDQogIGdlb21fcG9pbnRyYW5nZSgpICsNCiAgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gMCwNCiAgICAgICAgICAgICBsaW5ldHlwZSA9IDIsDQogICAgICAgICAgICAgY29sb3IgPSAicmVkIikgKw0KICBsYWJzKHggPSAi6YG45oyZ6LK755So77yI5Y2Y5L2N77yaMTAw5LiH5YaG77yJIiwgDQogICAgICAgeSA9ICLpgbjmjJnosrvnlKjjga7lubPlnYfpmZDnlYzlirnmnpzvvIhBTUXvvIkiKQ0KYGBgDQoNCiMg5YiG5p6Q57WQ5p6c44Gu6Kej6YeIDQoNCuWIhuaekOOBjOe1guOCj+OBo+OBn+OBqOOBl+OBpuOCguOAgeawl+OCkuaKnOOBhOOBpuOBr+OBhOOBkeOBquOBhOOAgg0K44Ki44Kr44OH44Of44OD44Kv44Gq5LiW55WM44Gq44KJ44Gw6KuW5paH44Gr44CB44OT44K444ON44K544Gu5LiW55WM44Gq44KJ5aCx5ZGK5pu444Gr44CB44GT44Gu5YiG5p6Q57WQ5p6c44KS44G+44Go44KB5LiK44GS44Gq44GP44Gm44Gv44Gq44KJ44Gq44GE44CCDQrliIbmnpDntZDmnpzjgpLjgb7jgajjgoHjgovjgavjga/jgIHph43lm57luLDliIbmnpDjga7ooajjgaDjgZHjgafjga/jgarjgY/jgIHjgq3jg6Pjgr/jg5Tjg6njg7zjg5fjg63jg4Pjg4jjgoTjg5njg7zjgr/lgKTjgpLlh7rjgZfjgabjgYrjgY/lv4XopoHjgYzjgYLjgovjgIINCuS7iuWbnuOBruWIhuaekOOCkuOBvuOBqOOCgeOCi+OBqOOAgeOBk+OBhuOBquOCi+OAgg0KDQrmnKzliIbmnpDjga/jgIHjgIzpgbjmjJnosrvnlKjjgYzlvZPpgbjnorrnjofjgavkuI7jgYjjgovlvbHpn7/jga/jganjgozjgbvjganjgYvjgI3jgajjgYTjgYbllY/jgYTjgavlr77jgZfjgIHjg63jgrjjgrnjg4bjgqPjg4Pjgq/lm57luLDliIbmnpDjgpLnlKjjgYTjgabop6PmmI7jgpLoqabjgb/jgZ/jgIINCuOBneOBrue1kOaenOOAgemBuOaMmeiyu+eUqOOBqOmBuOaMmeOBruW9k+iQveOBq+OBr+e1seioiOeahOOBq+acieaEj+OBqumWouS/guOBq+OBguOCi+OBqOOCj+OBi+OBo+OBn+OAguOBvuOBn+OAgUFVQ+OBruWApOOBjOe0hDAuOTTjgajjgIHjg6Ljg4fjg6vjgavntYTjgb/ovrzjgpPjgafjgYTjgarjgYTlpInmlbDjga7lvbHpn7/jgpLnhKHoppbjgafjgY3jgovjgafjgYLjgo3jgYbjgZPjgajjgYvjgonjgIHnorrluqbjga7pq5jjgYTntZDmnpzjgafjgYLjgovjgajoqIDjgYjjgovjgIINCue1seWItuWkieaVsOOCkuW5s+Wdh+WApOOBp+WbuuWumuOBl+OAgemBuOaMmeiyu+eUqOOBoOOBkeOCkuWkieWMluOBleOBm+OBn+WgtOWQiOOBruS6iOa4rOeiuueOh+OBruWbs+OBi+OCieOAgemBuOaMmeiyu+eUqOOCkuWJiuOCi+OBk+OBqOOBr+W+l+etluOBp+OBr+OBquOBhOOBqOOCj+OBi+OCi+OAgg0K5bmz5Z2H6ZmQ55WM5Yq55p6c44Gv6YG45oyZ6LK755So44GM6auY44GP44Gq44KL44Gr44Gk44KM44Gm5LiK5piH44GX44CBMOOBruODqeOCpOODs+OBqzk1JeS/oemgvOWMuumWk+OBjOOBi+OBi+OCi+OBk+OBqOOBjOOBquOBhOOAgg0K44GT44Gu44GT44Go44GL44KJ44KC44CB6YG45oyZ6LK755So44GM56K644GL44Gr5b2T6JC944Gr6Zai5L+C44GX44Gm44GE44KL44GT44Go44GM5YiG44GL44KL44CC44Gf44Gg44CB5b2x6Z+/44Gv5bCP44GV44GP44CB5a6f6LOq55qE44Gq5pyJ5oSP5oCn44Gv44Gq44GE44Go6ICD44GI44KJ44KM44KL44CC6Z2e5bi444Gr44Kz44K544OR44GM5oKq44GE44CCDQrjgZ/jgaDjgIHmiYDlsZ7mlL/lhZrjgoTlvZPpgbjlm57mlbDjga/oh6rjgonjga7mhI/mgJ3jgafmsbrjgoHjgovjgZPjgajjga/jgafjgY3jgarjgYTjgZ/jgoHjgIHpgbjmjJnjgavli53jgaTjgZ/jgoHjgavjga/oh6rjgonoqK3lrprjgafjgY3jgovpgbjmjJnosrvnlKjjga/pnZ7luLjjgavph43opoHjgaropoHlm6DjgafjgYLjgo3jgYbjgILjgrPjgrnjg5Hjga/mgqrjgYTjgYzjgIHjgrPjgrnjg4jjgpLjgYvjgZHjgZbjgovjgpLjgYjjgarjgYTjgaDjgo3jgYbjgIINCg0K5Lul5LiK44Gu44KI44GG44Gr44Gq44KL44CCDQroq5bmlofjgafjgYLjgozjgbDjgoLjgYblsJHjgZfoq5bmlofjga7nm67nmoTjgpLmjK/jgorov5TjgaPjgabjgoLoia/jgYTjgaDjgo3jgYbjgIINCg0KZW5qb3kgIQ0KDQoNCjxIUj4NCg0K44GT44Gu6KiY5LqL44Gu44Kz44O844OJ44KS44G+44Go44KB44Gf44KC44Gu44GvW0dpdGh1Yl0oaHR0cHM6Ly9naXRodWIuY29tL0ZydWl0R3Jhbm9sYS9SX0xvZ2lzdGljX1JlZ3Jlc3Npb24p44Gr44GC44KK44G+44GZ44CCDQoNCjxidXR0b24+W0hvbWXjgavmiLvjgotdKGluZGV4Lmh0bWwpPC9idXR0b24+DQo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Logistic_Regression.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
